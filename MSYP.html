<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>èª²è¼”å°å¸«ã€å­¸æœŸé–“å¸¶ç­æ´¥è²¼ã€‘è¨ˆç®—å™¨</title>
  <style>
    body {
      font-family: "Microsoft JhengHei", sans-serif;
      padding: 20px;
      line-height: 1.5;
    }
    input[type="number"], input[type="text"] {
      width: 120px;
      margin-right: 10px;
      padding: 4px;
    }
    label {
      margin-top: 10px;
      display: inline-block;
    }
    .block {
      border: 1px solid #aaa;
      padding: 15px;
      margin-bottom: 15px;
      border-radius: 8px;
      background-color: #f9f9f9;
    }
    .student-row {
      margin-bottom: 8px;
    }
    button {
      padding: 8px 16px;
      margin-top: 10px;
      font-size: 16px;
      cursor: pointer;
    }
    pre {
      background: #eee;
      padding: 10px;
      border-radius: 5px;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>

<h2>ğŸ“Š å°å¸«æ´¥è²¼è¨ˆç®—å™¨-æ°¸å¹³</h2>

<div class="block">
  <label>ğŸ‘©â€ğŸ« å°å¸«å§“åï¼ˆå¯ä¸å¡«ï¼‰ï¼š</label>
  <input type="text" id="teacherName" placeholder="ä¾‹å¦‚ ç‹è€å¸«">
  <br>
  <label>ğŸ”¢ å…¨æœˆäººæ•¸ï¼š</label>
  <input type="number" id="fullMonthCount" placeholder="ä¾‹å¦‚ 21">
  <br>
  <label>å…¨æœˆæ´¥è²¼æ¯”ä¾‹ï¼ˆå­¸æœŸé–“å¤©æ•¸ / è©²æœˆå·¥ä½œå¤©æ•¸ï¼‰ï¼š</label>
  <input type="number" id="stipendRatio" value="1" step="0.01">
  <p>èªªæ˜ï¼šå­¸æœŸé–“å¤©æ•¸ / è©²æœˆå·¥ä½œå¤©æ•¸ã€‚é è¨­æ¯”ä¾‹ç‚º 1ã€‚</p>
</div>

<div class="block">
  <h3>ğŸ‘¶ éå…¨æœˆå­¸ç”Ÿè³‡è¨Šï¼ˆæœ€å¤šäº”ä½ï¼‰</h3>
  <div id="students">
    <div class="student-row"><input type="text" id="name0" placeholder="å§“å1"><input type="number" id="days0" placeholder="å¯¦ä¸Šå¤©æ•¸"><input type="number" id="totalDays0" placeholder="æ‡‰ä¸Šå¤©æ•¸"></div>
    <div class="student-row"><input type="text" id="name1" placeholder="å§“å2"><input type="number" id="days1" placeholder="å¯¦ä¸Šå¤©æ•¸"><input type="number" id="totalDays1" placeholder="æ‡‰ä¸Šå¤©æ•¸"></div>
    <div class="student-row"><input type="text" id="name2" placeholder="å§“å3"><input type="number" id="days2" placeholder="å¯¦ä¸Šå¤©æ•¸"><input type="number" id="totalDays2" placeholder="æ‡‰ä¸Šå¤©æ•¸"></div>
    <div class="student-row"><input type="text" id="name3" placeholder="å§“å4"><input type="number" id="days3" placeholder="å¯¦ä¸Šå¤©æ•¸"><input type="number" id="totalDays3" placeholder="æ‡‰ä¸Šå¤©æ•¸"></div>
    <div class="student-row"><input type="text" id="name4" placeholder="å§“å5"><input type="number" id="days4" placeholder="å¯¦ä¸Šå¤©æ•¸"><input type="number" id="totalDays4" placeholder="æ‡‰ä¸Šå¤©æ•¸"></div>
  </div>
</div>

<div class="block">
  <h3>æ‰£é™¤è«‹äººä»£èª²çš„æ´¥è²¼</h3>
  <label>ğŸ“… æœ¬æœˆå·¥ä½œå¤©æ•¸ï¼š</label>
  <input type="number" id="workDays" placeholder="ä¾‹å¦‚ 22">
  <br>
  <label>ğŸ•’ ä»£èª²å¤©æ•¸ï¼š</label>
  <input type="number" id="leaveDays" placeholder="ä¾‹å¦‚ 1">
  <label>â° ä»£èª²å°æ™‚æ•¸ï¼š</label>
  <input type="number" id="leaveHours" placeholder="ä¾‹å¦‚ 3">
</div>

<button onclick="calculate()">âœ… è¨ˆç®—æ´¥è²¼</button>
<button onclick="copyResult()">ğŸ“‹ è¤‡è£½çµæœ</button>

<h3>çµæœï¼š</h3>
<pre id="result"></pre>

<script>
  function getStipendByCount(count) {
    if (count >= 35) return 16000;
    const table = {
      16: 600, 17: 1200, 18: 1800, 19: 2400, 20: 3000,
      21: 4200, 22: 4900, 23: 5600, 24: 6300, 25: 7000,
      26: 8800, 27: 9600, 28: 10400, 29: 11200, 30: 12000,
      31: 12800, 32: 13600, 33: 14400, 34: 15200, 35: 16000
    };
    return table[count] || 0;
  }

  function getPerStudentByCount(count) {
    if (count >= 16 && count <= 20) return 600;
    if (count >= 21 && count <= 25) return 700;
    if (count >= 26) return 800;
    return 0;
  }

  function calculate() {
    const count = parseInt(document.getElementById("fullMonthCount").value);
    const teacher = document.getElementById("teacherName").value.trim();
    const workDays = parseInt(document.getElementById("workDays").value);
    const leaveDays = parseInt(document.getElementById("leaveDays").value) || 0;
    const leaveHours = parseInt(document.getElementById("leaveHours").value) || 0;
    const stipendRatio = parseFloat(document.getElementById("stipendRatio").value);

    if (isNaN(count) || count <= 0) {
      alert("âš ï¸ è«‹è¼¸å…¥æ­£ç¢ºçš„ã€å…¨æœˆäººæ•¸ã€‘ï¼");
      return;
    }

    const baseStipend = getStipendByCount(count);
    const perStudentStipend = getPerStudentByCount(count);

    let total = baseStipend * stipendRatio;
    let output = ` +å…¨æœˆäººæ•¸ï¼š${count}äºº âœ æ´¥è²¼ï¼š${(baseStipend * stipendRatio).toFixed(2)} å…ƒï¼ˆæ¯”ä¾‹ï¼š${stipendRatio}ï¼‰`;

    let nonFullCount = 0;
    let nonFullTotal = 0;

    for (let i = 0; i < 5; i++) {
      const name = document.getElementById(`name${i}`).value.trim();
      const days = parseInt(document.getElementById(`days${i}`).value);
      const totalDays = parseInt(document.getElementById(`totalDays${i}`).value);

      if (name && !isNaN(days) && !isNaN(totalDays) && days > 0 && totalDays > 0) {
        const partial = Math.ceil(perStudentStipend / totalDays * days);
        total += partial;
        nonFullCount++;
        nonFullTotal += partial;
        output += `\n +${name}ï¼š(${perStudentStipend} Ã· ${totalDays} Ã— ${days}) = ${partial} å…ƒ`;
      }
    }

    if (total > 16000) {
      output += `\nğŸ”’ è¨ˆç®—ç¸½é¡è¶…éä¸Šé™ï¼Œå·²èª¿æ•´ç‚º 16000 å…ƒ`;
      total = 16000;
    }

    output += `\n\n å°è¨ˆï¼š${Math.round(total)} å…ƒ`;

    if (workDays && (leaveDays > 0 || leaveHours > 0)) {
      const daily = total / workDays;
      const hourly = daily / 8;
      const leaveDeduction = Math.round(daily * leaveDays + hourly * leaveHours);

      output += `\n\n -ä»£èª²æ‰£é™¤éƒ¨ä»½è¨ˆç®—ï¼ˆ${leaveDays} å¤© ${leaveHours} å°æ™‚ï¼‰ï¼š`;
      output += `\nã€€ æ‰£é™¤è¨ˆç®—ï¼š(${total} Ã· ${workDays} Ã— ${leaveDays}) + (${total} Ã· ${workDays} Ã· 8 Ã— ${leaveHours}) = ${leaveDeduction} å…ƒ`;

      total -= leaveDeduction;
    }

    output += `\n\n${teacher ? ` ${teacher}æœ¬æœˆå¸¶ç­æ´¥è²¼åˆè¨ˆ` : "ğŸ’° å¸¶ç­æ´¥è²¼ç¸½é¡"}ï¼š${Math.round(total)} å…ƒ`;

    document.getElementById("result").innerText = output;
  }

  function copyResult() {
    const text = document.getElementById("result").innerText;
    if (text.trim() === "") {
      alert("âš ï¸ è«‹å…ˆè¨ˆç®—å¾Œå†è¤‡è£½ï¼");
      return;
    }
    navigator.clipboard.writeText(text).then(() => {
      alert("âœ… çµæœå·²è¤‡è£½ï¼");
    });
  }
</script>

</body>
</html>
