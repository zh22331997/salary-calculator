<!DOCTYPE html>
<html lang="zh-TW">
<head>
 <meta charset="UTF-8" />
 <title>æ­£è¯æˆ¶å¤–æ´»å‹•åç‰Œç”¢ç”Ÿå™¨v3</title>
 <meta name="viewport" content="width=device-width, initial-scale=1" />
 <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
 <style>
  /* å…¨å±€æ¨£å¼ */
  body {
   font-family: 'Noto Sans TC', "Microsoft JhengHei", sans-serif;
   background: #f0f2f5;
   margin: 0;
   padding: 0;
   display: flex;
   justify-content: center;
   align-items: flex-start;
   min-height: 100vh;
  }

  /* ä¸»è¦å…§å®¹å®¹å™¨ */
  .container {
   background: #ffffff;
   padding: 2rem;
   margin: 2rem 1rem;
   border-radius: 12px;
   box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
   max-width: 960px;
   width: 100%;
   box-sizing: border-box;
  }

  h2, h3 {
   color: #333;
   border-bottom: 2px solid #e0e0e0;
   padding-bottom: 0.5rem;
   margin-top: 1.5rem;
   margin-bottom: 1rem;
  }

  input, textarea {
   width: calc(100% - 1rem);
   padding: 0.75rem;
   margin-bottom: 1rem;
   border-radius: 8px;
   border: 1px solid #ccc;
   font-size: 16px;
   box-sizing: border-box;
   transition: border-color 0.3s ease;
  }

  input:focus, textarea:focus {
   border-color: #6a9aff;
   outline: none;
  }

  label {
   font-weight: bold;
   margin-top: 1rem;
   display: block;
   color: #555;
   margin-bottom: 0.5rem;
  }

  .row {
   display: flex;
   gap: 1.5rem;
   flex-wrap: wrap;
  }

  .col {
   flex: 1;
   min-width: 280px;
  }

  button {
   padding: 0.8rem 1.5rem;
   font-size: 17px;
   border: none;
   border-radius: 8px;
   cursor: pointer;
   background-color: #4e73df;
   color: white;
   margin-right: 0.8rem;
   margin-top: 1rem;
   transition: background-color 0.3s ease, transform 0.2s ease;
  }

  button:hover {
   background-color: #2e59d9;
   transform: translateY(-2px);
  }

  button:active {
   transform: translateY(0);
  }

  p {
   color: #666;
   font-size: 0.95rem;
   line-height: 1.5;
  }

  code {
   background-color: #f0f0f0;
   padding: 2px 5px;
   border-radius: 4px;
   font-family: monospace;
  }

  /* --- åç‰Œé¡¯ç¤ºæ¨£å¼ --- */
  .card-container {
   display: flex;
   flex-wrap: wrap;
   gap: 0;
   justify-content: flex-start !important; /* è®“åç‰Œé å·¦ç½®ä¸­ */
   margin-top:0;
  }

  .name-card {
   width: 8.5cm; /* åç‰Œå¯¬åº¦ */
   height: 5.5cm; /* åç‰Œé«˜åº¦ */
   box-sizing: border-box;
   background: white;
   border: 1px solid #aaa;
   border-radius: 0;
   padding: 0.25cm;
   overflow: hidden;
   page-break-inside: avoid;
   box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
   flex: none; /* è®“ width å±¬æ€§ç›´æ¥æ§åˆ¶åç‰Œå¯¬åº¦ */
   margin-bottom: 0; /* ç‚ºæ¯å€‹åç‰Œå¢åŠ åº•éƒ¨å¤–é‚Šè·ï¼Œé¿å…å¤ªæ“  */

   display: flex;
   flex-direction: column;
   justify-content: space-between;
   align-items: center;
   text-align: center; /* ç¢ºä¿åç‰Œå…§çš„æ–‡å­—æ°´å¹³ç½®ä¸­ */

   position: relative; /* ç¢ºä¿å½å…ƒç´ èƒ½ç›¸å°æ–¼åç‰Œå®šä½ */
   overflow: hidden; /* é˜²æ­¢æµ®æ°´å°è¶…å‡ºåç‰Œé‚Šç•Œ */
  }

    /* åç‰Œé ‚éƒ¨è³‡è¨Š */
  .card-header-top {
   width: 100%;
   display: flex;
   justify-content: center;
   font-size: 11.5pt;
   font-weight: 700;
   color: #333;
   margin-top: 0;
   margin-bottom: 0;
   
   position: relative; /* ç¢ºä¿æ–‡å­—å±¤æ¬¡åœ¨æµ®æ°´å°ä¹‹ä¸Š */
   z-index: 1; /* æ¯”æµ®æ°´å°çš„ z-index é«˜ */
   
  }
  .card-header-top span:first-child {
   margin-right: 0.4em;
  }

  /* æ´»å‹•åç¨± */
  .card-event {
   width: 100%;
   font-size: 13pt;
   font-weight: 900;
   color: #000;
   margin-bottom: 0.2cm;
   line-height: 1.2;
   position: relative; /* ç¢ºä¿æ–‡å­—å±¤æ¬¡åœ¨æµ®æ°´å°ä¹‹ä¸Š */
   z-index: 1; /* æ¯”æµ®æ°´å°çš„ z-index é«˜ */
   
  }

  /* å­¸ç”Ÿå§“å */
  .card-name {
   font-size: 24pt;
   font-weight: 900;
   color: #333;
   line-height: 1.1;
   margin-bottom: 0.05cm;
   position: relative; /* ç¢ºä¿æ–‡å­—å±¤æ¬¡åœ¨æµ®æ°´å°ä¹‹ä¸Š */
   z-index: 1; /* æ¯”æµ®æ°´å°çš„ z-index é«˜ */
  }

  /* è»Šæ¬¡çµ„åˆ¥ */
  .card-group {
   font-size: 14pt;
   font-weight: 700;
   color: #555;
   margin-bottom: 0; /* ç§»é™¤åº•éƒ¨å¤–é‚Šè· */
   line-height: 1.2;
   position: relative; /* ç¢ºä¿æ–‡å­—å±¤æ¬¡åœ¨æµ®æ°´å°ä¹‹ä¸Š */
   z-index: 1; /* æ¯”æµ®æ°´å°çš„ z-index é«˜ */
  }

  /* è€å¸«ä¸»ä»»è³‡è¨Šå€ */
  .card-footer {
   width: 100%;
   font-size: 11pt; /* é‡è¦çš„èª¿æ•´ï¼çµ±ä¸€å­—é«”å¤§å° */
   color: #444;
   line-height: 1.3;
   text-align: center; /* è®“åº•éƒ¨æ–‡å­—ç½®ä¸­ */
   padding-left: 0.2cm;
   padding-right: 0.2cm;
   margin-top: 0; /* ç§»é™¤é ‚éƒ¨å¤–é‚Šè· */
   margin-bottom: 0;
   position: relative; /* ç¢ºä¿æ–‡å­—å±¤æ¬¡åœ¨æµ®æ°´å°ä¹‹ä¸Š */
   z-index: 1; /* æ¯”æµ®æ°´å°çš„ z-index é«˜ */
  }
  .card-footer div {
      margin-bottom: 0.05cm;
      /* å­—å‹å’Œå­—é«”å¤§å°ç”± .card-footer çµ±ä¸€æ§åˆ¶ï¼Œä¸å†å–®ç¨è¨­ç½® */
  }
  .card-footer div:last-child {
      margin-bottom: 0;
  }
  /* ç§»é™¤ .card-footer span.phone çš„ç¨ç«‹æ¨£å¼ï¼Œä½¿å…¶ç¹¼æ‰¿çˆ¶å±¤ */
  /* .card-footer span.phone {
    font-size: 8pt;
    color: #666;
    word-wrap: break-word;
  } */
  /* åˆ—å°æ™‚æµ®æ°´å°æ¨£å¼ (é€™æ˜¯æ–°çš„å€å¡Š) */
   .name-card::before {
    content: "" !important;
    position: absolute !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    width: 80% !important; /* ç¢ºä¿åˆ—å°æ™‚å¯¬åº¦ç”Ÿæ•ˆ */
    height: 80% !important; /* ç¢ºä¿åˆ—å°æ™‚é«˜åº¦ç”Ÿæ•ˆ */
    background-image: url('https://github.com/zh22331997/salary-calculator/blob/main/2019%20zh%20logo.png?raw=true') !important; /* **è«‹ç¢ºä¿æ­¤è™•æ˜¯æ‚¨çš„ LOGO åœ–ç‰‡ç¶²å€ï¼** */
    background-size: contain !important;
    background-repeat: no-repeat !important;
    background-position: center !important;
    opacity: 0.1 !important; /* èª¿æ•´é€æ˜åº¦ */
    z-index: 0 !important;
    pointer-events: none !important;
   }

  /* --- åˆ—å°æ¨£å¼ --- */
  @media print {
   @page { size: A4 portrait; margin: 0.8cm; }
   /* é‡è¦çš„ä¿®æ”¹ï¼šå°‡é™¤äº† .card-container ä¹‹å¤–çš„æ‰€æœ‰å…§å®¹éš±è— */
   body > *:not(.container) {
    display: none !important;
   }
   .container > *:not(.card-container) {
    display: none !important;
   }
   /* ç¢ºä¿ card-container æœ¬èº«åŠå…¶å…§å®¹æ˜¯å¯è¦‹çš„ */
   .card-container, .card-container * {
    visibility: visible;
    /* print media ä¸‹çš„ flex ä½ˆå±€éœ€è¦é‡æ–°ç¢ºèª */
    /* é€™è£¡ç‚ºäº†ç¢ºä¿åç‰Œå…§æ–‡å­—å’Œåç‰Œæ•´é«”ç½®ä¸­ï¼Œå†æ¬¡ç¢ºèªç›¸é—œå±¬æ€§ */
   }
   .container { /* åˆ—å°æ™‚è®“ container è®Šç‚ºæ²’æœ‰é‚Šè·å’Œé™°å½±çš„æ™®é€šå®¹å™¨ */
    box-shadow: none !important;
    border-radius: 0 !important;
    padding: 0 !important;
    margin: 0 !important;
    max-width: none !important;
    width: auto !important;
    display: flex !important; /* è®“ container åœ¨åˆ—å°æ™‚ä¹Ÿä½¿ç”¨ flexbox */
    justify-content: center !important; /* å°‡ card-container æ°´å¹³ç½®ä¸­ */
   }
  
  .name-card::before {
    opacity: 0.1 !important;
  }


   .card-container {
    position: static !important; /* ç§»é™¤ä»»ä½•å¯èƒ½å½±éŸ¿å®šä½çš„è¨­å®š */
    top: auto !important;
    left: auto !important;
    padding: 0 !important;
    margin: 0 !important; /* ç§»é™¤ container è‡ªå·±çš„ margin */
    gap: 0 !important;
    justify-content: center !important; /* åˆ—å°æ™‚ä¹Ÿè®“åç‰Œåœ¨å®¹å™¨å…§æ°´å¹³ç½®ä¸­ */
    flex-wrap: wrap !important; /* å…è¨±æ›è¡Œ */
    width: 100% !important; /* ç¢ºä¿ card-container ä½”æ»¿å¯ç”¨å¯¬åº¦ï¼Œä»¥ä¾¿å…§éƒ¨åç‰Œç½®ä¸­ */
   }
   .name-card {
    width: 8.5cm !important; /* åˆ—å°æ™‚åç‰Œä¹Ÿè®Šçª„ */
    height: 5.5cm !important; /* ä¿æŒé«˜åº¦ */
    flex: none !important; /* åˆ—å°æ™‚ä¹Ÿè®“ width ç›´æ¥ç”Ÿæ•ˆ */
    border: 1px solid #777 !important;
    box-shadow: none !important;
    padding: 0.25cm !important;
    /* ç¢ºä¿åç‰Œå…§å®¹ä½ˆå±€åœ¨åˆ—å°æ™‚ä¾ç„¶æ­£ç¢º */
    display: flex !important;
    flex-direction: column !important;
    justify-content: space-between !important;
    align-items: center !important;
    border-radius: 0 !important;
    text-align: center !important;
    margin-bottom: 0 !important; /* åˆ—å°æ™‚ä¹Ÿä¿æŒåº•éƒ¨å¤–é‚Šè· */
    position: relative !important;
    overflow: hidden !important;
   }
   
   /* ç¢ºä¿æ–‡å­—åœ¨æµ®æ°´å°ä¹‹ä¸Š (åˆ—å°æ™‚ä¹Ÿç”Ÿæ•ˆ) */
   .card-header-top,
   .card-event,
   .card-name,
   .card-group,
   .card-footer {
    position: relative !important;
    z-index: 1 !important;
   }
   /* å¼·åˆ¶åˆ†é ï¼šæ¯ 10 å¼µåç‰Œå¾Œæ›é  */
   .name-card:nth-child(10n+10) {
  page-break-after: always !important;
  }
   /* é˜²æ­¢åç‰Œåœ¨åˆ—å°æ™‚è¢«åˆ†å‰² */
   .name-card {
    page-break-inside: avoid !important;
   }
  }
 .error-line {
  background-color: #ffecec;
  border-left: 4px solid red;
  padding: 4px 8px;
  margin-bottom: 4px;
  white-space: pre-wrap;
  font-family: monospace;
  font-size: 0.95em;
  color: #a00;
}
.error-summary {
  color: #b30000;
  font-weight: bold;
  margin-top: 8px;
}
.success-summary {
  color: #007700;
  font-weight: bold;
  margin-top: 8px;
}



 </style>
</head>
<body>
 <div class="container">
  <h1>æ­£è¯æˆ¶å¤–æ´»å‹•åç‰Œç”¢ç”Ÿå™¨v3</h1>
  <h2>ğŸ“‹ æ´»å‹•è¨­å®š</h2>
  <div class="row">
   <div class="col">
    <label for="schoolName">åˆ†æ ¡åç¨±</label>
    <input type="text" id="schoolName" value="æ°¸å¹³åˆ†æ ¡" />
   </div>
   <div class="col">
    <label for="eventName">æ´»å‹•åç¨±</label>
    <input type="text" id="eventName" value="æˆ¶å¤–ä¸€æ—¥ç‡Ÿ" />
   </div>
  </div>
  <label for="director">å¸¶éšŠä¸»ä»»</label>
  <input type="text" id="director" value="OOä¸»ä»»0900-123-456" />

  <h3>ğŸ“š å­¸ç”Ÿè³‡æ–™</h3>
  <p><p style="font-size: 0.9em; color: #555;">
  âœ… è«‹å¾ Excel è²¼ä¸Šä¸‰æ¬„æˆ–å››æ¬„ï¼š<code>å§“åã€Tabã€‘è»Šæ¬¡ã€Tabã€‘ï¼ˆæ¡Œæ¬¡ï¼‰ã€Tabã€‘è€å¸«èˆ‡é›»è©±</code><br>
  ç³»çµ±æœƒè‡ªå‹•åˆ¤æ–·æ˜¯å¦æœ‰æ¡Œæ¬¡ï¼Œè»Šæ¬¡å¯å¯«ã€Œç¬¬3è»Šã€æˆ–ã€Œç¬¬3è»Šæ¬¡ã€ï¼Œéƒ½èƒ½è¾¨è­˜ã€‚<br>
  <strong>ä¸€å®šè¦å¾ Excel è¤‡è£½ è³‡æ–™ è²¼ä¸Š</strong>ï¼Œè«‹å‹¿è‡ªå·±ç›´æ¥è¼¸å…¥è³‡æ–™åœ¨é€™å€‹ç¶²é ï¼Œå®ƒæœ‰å¯èƒ½æœƒåˆ¤è®€éŒ¯èª¤ã€‚
</p>
<textarea id="inputArea" placeholder="ä¾‹å¦‚
ç‹å°æ˜ã€€ç¬¬1è»Šæ¬¡ã€€ç¬¬1æ¡Œã€€Tinaè€å¸« 0900-111-222
å¼µé£›   ç¬¬3è»Š    ç¬¬8æ¡Œ   Ann0911-111111" rows="8"></textarea>

  <div>
   <button onclick="generateCards()">ç”Ÿæˆåç‰Œ</button>
   <button onclick="window.print()">åˆ—å°åç‰Œ</button>
  </div>
  <div id="errorMsg" style="color: red; margin-top: 1rem; font-weight: bold;"></div>

  <div class="card-container" id="cardContainer"></div>
 </div>

 <script>
function generateCards() {
  const school = document.getElementById("schoolName").value.trim();
  const event = document.getElementById("eventName").value.trim();
  const director = document.getElementById("director").value.trim();
  const input = document.getElementById("inputArea").value.trim();
  const container = document.getElementById("cardContainer");
  container.innerHTML = ""; // æ¸…ç©ºèˆŠåç‰Œ

  const lines = input.split(/\r?\n/);
  const errorContainer = document.getElementById("errorMsg");
errorContainer.innerHTML = ""; // âœ… å®Œå…¨æ¸…ç©ºæ‰€æœ‰éŒ¯èª¤è¨Šæ¯
  let errorCount = 0;

 const pattern4 = /^(\S+)\t(ç¬¬\s*\S+\s*è»Š(?:æ¬¡)?)\t(ç¬¬\S+æ¡Œ)\t(.+?)\s*(09\d{2}-?\d{3}-?\d{3})$/;
const pattern3 = /^(\S+)\t(ç¬¬\s*\S+\s*è»Š(?:æ¬¡)?)\t(.+?)\s*(09\d{2}-?\d{3}-?\d{3})$/;

for (const [index, line] of lines.entries()) {
  if (line.trim() === "") continue;

  const cleanedLine = line.replace(/[\u3000\u00A0]/g, ' ').trim();
  let match = cleanedLine.match(pattern4); // å…ˆè©¦å››æ¬„æ ¼å¼
  let group = "", name = "", leader = "", teacherPhone = "", teacherName = "";

  if (match) {
    name = match[1];
    const car = match[2].replace(/\s+/g, '');
    const table = match[3].replace(/\s+/g, '');
    group = `${car} ${table}`;
    teacherName = match[4].trim();
    teacherPhone = match[5];
  } else {
    match = cleanedLine.match(pattern3); // å†è©¦ä¸‰æ¬„æ ¼å¼
    if (!match) {
  const errorDiv = document.createElement("div");
  errorDiv.className = "error-line";
  errorDiv.innerText = `ç¬¬ ${index + 1} è¡Œæ ¼å¼éŒ¯èª¤ï¼š${line}`;
  document.getElementById("errorMsg").appendChild(errorDiv);
  errorCount++;
  continue;
}

    name = match[1];
    const car = match[2].replace(/\s+/g, '');
    group = `${car}`; // æ²’æœ‰æ¡Œæ¬¡
    teacherName = match[3].trim();
    teacherPhone = match[4];
  }

  leader = `${teacherName} ${teacherPhone}`;

  const card = document.createElement("div");
  card.className = "name-card";
  card.innerHTML = `
    <div class="card-bg"></div>
    <div class="card-header-top">
      <span>æ­£è¯å­¸è‹‘</span><span>${school}</span>
    </div>
    <div class="card-event">${event}</div>
    <div class="card-name">${name}</div>
    <div class="card-group">${group}</div>
    <div class="card-footer">
      <div>å¸¶éšŠè€å¸«ï¼š${leader}</div>
      <div>å¸¶éšŠä¸»ä»»ï¼š${director}</div>
    </div>
  `;
  container.appendChild(card);
}




 
// âœ… æ”¾åœ¨ for è¿´åœˆä¹‹å¾Œï¼
// æ”¾åœ¨ for è¿´åœˆä¹‹å¾Œï¼
const count = container.childElementCount;

if (count > 0) {
  const successMsg = document.createElement("div");
  successMsg.className = "success-summary";
  successMsg.innerHTML = `âœ… å…±æˆåŠŸç”¢ç”Ÿ ${count} å¼µåç‰Œã€‚`;
  errorContainer.appendChild(successMsg);
}

if (errorCount > 0) {
  const summary = document.createElement("div");
  summary.className = "error-summary";
  summary.style.marginTop = "8px";
  summary.innerHTML = `âš ï¸ å…± ${errorCount} ç­†è³‡æ–™æ ¼å¼ä¸æ­£ç¢ºï¼Œè«‹æª¢æŸ¥ä¸Šæ–¹éŒ¯èª¤ã€‚`;
  errorContainer.appendChild(summary);
}


}


</script>
</body>
</html>
