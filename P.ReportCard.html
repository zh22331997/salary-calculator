<!DOCTYPE html> 
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>å€‹äººæˆç¸¾å–®ç”¢ç”Ÿå™¨</title>
  <style>
/* =========================
   Design System (Tokens)
   ========================= */
:root{
  --brand-500:#A1C6EA; --brand-600:#8FB9E2;
  --secondary-500:#BBD1EA; --secondary-600:#A8C5E6;
  --clear-500:#DAE3E5; --clear-600:#CFD9DC;

  --text-strong:#1f2937; --text-normal:#374151; --text-mute:#6b7280;
  --border:#d1d5db;
  --bg-page:#f0f2f5; --bg-card:#ffffff; --bg-info:#f8fbff; --bg-info-border:#e1eefc;

  --font-sans:"Microsoft JhengHei","å¾®è»Ÿæ­£é»‘é«”","Noto Sans TC","PingFang TC","Heiti TC",sans-serif;
  --font-mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono",monospace;

  --radius-lg:12px; --shadow-lg:0 4px 20px rgba(0,0,0,.12);

  --input-height:2.75rem; --btn-height:2.9rem;

  /* å¯èª¿å­—ç´šï¼ˆé è¨­ï¼‰ */
  --fs-personal:14px;
  --fs-rank:14px;
  --fs-teacher:14px;

  /* é è¦½ç´™å¼µå¯¬åº¦ï¼ˆæœƒè¢« JS ä¾ A4/B5 è¦†å¯«ï¼‰ */
  --sheet-width-mm:160mm;
}

/* =========================
   Base
   ========================= */
*{box-sizing:border-box}
html,body{height:100%}
body{
  font-family:var(--font-sans);
  background:var(--bg-page);
  margin:0; padding:0;
  color:var(--text-normal);
}
#controls{
  background:var(--bg-card);
  padding:2rem; margin:2rem auto 1rem; border-radius:var(--radius-lg);
  box-shadow:var(--shadow-lg); max-width:1100px; width:calc(100% - 2rem);
}
h2{margin:0 0 1rem; color:#0056b3; text-align:center; font-weight:800;}
h3{color:var(--text-strong); border-bottom:2px solid #e0e0e0; padding-bottom:.5rem; margin-top:1.25rem; margin-bottom:.75rem;}
label{font-weight:700; color:#555;}
p{color:#444; font-size:.95rem; line-height:1.6}

textarea, input, select{ font-family:inherit; font-size:16px; }
textarea, input[type="text"], input[type="number"], select{
  width:100%; height:var(--input-height); padding:0 .9rem;
  border-radius:8px; border:1px solid var(--border); background:#fff;
}
textarea{ min-height:160px; height:auto; padding:.75rem; line-height:1.5; font-family:var(--font-mono); }
textarea:focus, input:focus, select:focus{ outline:none; box-shadow:0 0 0 3px rgba(106,154,255,.25); border-color:#6a9aff; }

button{
  display:inline-flex; align-items:center; justify-content:center;
  min-height:var(--btn-height); padding:0 1.1rem; font-size:17px; font-weight:700;
  border:none; border-radius:8px; cursor:pointer; color:#17324A;
  background:var(--brand-500); transition:background .15s ease, transform .12s ease, box-shadow .2s;
}
button:hover{ background:var(--brand-600); transform:translateY(-2px) }
.btn-secondary{ background:var(--secondary-500); }
.btn-secondary:hover{ background:var(--secondary-600); }
.btn-clear{ background:var(--clear-500); }
.btn-clear:hover{ background:var(--clear-600); }
.btn-row{ display:flex; gap:12px; justify-content:center; flex-wrap:wrap; margin-top:.75rem; }

.small-text{ font-size:10pt; color:var(--text-mute); }
.red-title{ color:#b91c1c; font-weight:bold; margin-top:10px; }

/* ========== é è¦½å€ï¼šä¸€å¼µã€Œæœ‰é‚Šæ¡†çš„ç´™ã€è€Œä¸æ˜¯å…¨å¯¬ ========== */
#output{
  display:flex; flex-direction:column; align-items:center; gap:24px;
  padding:16px 0 48px;
}
.b5{
  background:#fff; color:#000;
  width:var(--sheet-width-mm); max-width:calc(100% - 32px);
  margin:0 auto; padding:12mm;
  border:1px solid #000;
  box-shadow:0 2px 18px rgba(0,0,0,.08);
  page-break-inside: avoid;
}

/* è¡¨æ ¼ï¼šå…¨é»‘æ¡†ï¼ˆè¢å¹•ï¼‹åˆ—å°ä¸€è‡´ï¼‰ */
table{ width:100%; border-collapse:collapse; margin-top:10px; background:#fff; border:1px solid #000; }
th, td{ border:1px solid #000; text-align:center; padding:6px; font-size:14px; color:#000; background:#fff; }

/* å€å¡Šï¼šå¥—å¯èª¿å­—ç´š */
.personal-table{ font-size:var(--fs-personal); }
.rank-table{ font-size:var(--fs-rank); }
.teacher-box{
  border:1px solid #000; padding:8px; white-space:pre-line; line-height:1.6;
  font-size:var(--fs-teacher);
}
.teacher-box::after{ content:"\A"; white-space:pre; }

/* ç°½åå€ */
.signature-table{ border:none!important; box-shadow:none!important; background:transparent!important; margin-top:12px; }
.signature-table td, .signature-table th{ border:none!important; background:transparent!important; color:#000; }

/* select æ¢å¾©ç™½åº•é»‘å­— */
h2 select, p select, #controls select{
  appearance:auto !important; background:#fff !important; color:#000 !important; border:1px solid var(--border) !important;
  height:2rem !important; font-size:14px !important; border-radius:6px !important; padding:0 .5rem !important; width:auto !important;
}

/* =========================
   åˆ—å°ï¼šé è¨­ A4ï¼ˆJS æœƒè¦†å¯«ï¼‰ï¼Œç”¨ç´™å¼µé‚Šç•Œç•¶å¤–æ¡†
   ========================= */
@page { size:A4 portrait; margin:10mm; }
@media print{
  html, body{ width:210mm; height:auto; margin:0; padding:0; background:#fff; color:#000; }
  #controls{ display:none!important; }
  #output{ display:block; }
  .b5{
    width:var(--sheet-width-mm) !important;
    max-width:none !important;
    margin:0 auto !important;
    padding:12mm !important;
    /* åˆ—å°æ™‚å¤–æ¡†èˆ‡é™°å½±ç§»é™¤ï¼Œæ”¹ç”¨ç´™å¼µé‚Šç•Œç•¶æ¡† */
    border:none !important;
    box-shadow:none !important;
    page-break-after:always; break-after:page;
    background:#fff !important; color:#000 !important;
  }
  *{ -webkit-print-color-adjust: exact; print-color-adjust: exact; }
}
  </style>
</head>

<body>

<div id="controls">
  <h2>æ­£è¯è³‡å„ªæ•™è‚²å­¸è‹‘
    <select id="branch">
      <option>æ°¸å¹³</option><option>ç§€æœ—</option><option>æ¸…æ°´</option><option>æ°¸å’Œ</option><option>æ±Ÿç¿ </option>
    </select>åˆ†æ ¡
  </h2>

  <p style="text-align:center">
    <input id="schoolYear" size="4" readonly>å­¸å¹´
    <select id="grade"><option>ä¸€</option><option>äºŒ</option><option>ä¸‰</option><option>å››</option><option>äº”</option><option selected>å…­</option></select>å¹´ç´š
    <select id="semester"><option>ä¸Š</option><option>ä¸‹</option></select>å­¸æœŸ
    <select id="examType"><option>ä¸­</option><option>æœ«</option></select>è€ƒ å­¸ç”Ÿæˆç¸¾å–®
  </p>

  <h3>è«‹å¾ EXCEL è²¼ä¸Šå…¨ç­æˆç¸¾è³‡æ–™ï¼ˆå«æ¨™é¡Œåˆ—ï¼‰</h3>
  <textarea id="rawInput" placeholder="å§“å[TAB]åœ‹èª[TAB]æ•¸å­¸[TAB]è‡ªç„¶[TAB]ç¤¾æœƒ[TAB]è‹±æ–‡"></textarea>

  <h3>è«‹å¾ EXCEL è²¼ä¸Šç­å¹³å‡ï¼ˆä¾å¹´ç´šè‡ªå‹•ï¼‰</h3>
  <textarea id="avgPaste" placeholder="ä¸€äºŒå¹´ç´šï¼šåœ‹èª[TAB]æ•¸å­¸ï¼›ä¸‰ï½å…­å¹´ç´šï¼šåœ‹èª[TAB]æ•¸å­¸[TAB]è‡ªç„¶[TAB]ç¤¾æœƒ[TAB]è‹±æ–‡"></textarea>

  <div class="small-text" style="margin-top:6px">
    æ­£è¯ç­æ’å‰ <input id="targetIndex" type="number" value="5" style="width:60px; height:2rem"> åï¼ˆè‹¥æœ‰ä¸¦åˆ—ï¼Œæœƒè‡ªå‹•åŒ…å«ï¼‰
  </div>

  <h3>è€å¸«çš„è©±</h3>
  <textarea id="teacherComment" placeholder="è«‹è¼¸å…¥è€å¸«çš„è©±ï¼Œæœƒå‡ºç¾åœ¨æˆç¸¾å–®ä¸Š"></textarea>
  <div id="wordCount" class="small-text" style="margin-top:4px;">ç›®å‰å­—æ•¸ï¼š0 / å»ºè­°ä¸Šé™ 600</div>

  <!-- ä¸‰å€å­—ç´š -->
  <div style="display:flex; gap:12px; flex-wrap:wrap; align-items:center; margin-top:12px;">
    <label>å€‹äººæˆç¸¾å­—ç´š
      <select id="fsPersonal">
        <option value="13px">å°</option>
        <option value="14px" selected>ä¸­</option>
        <option value="15px">ä¸­åå¤§</option>
        <option value="16px">å¤§</option>
        <option value="18px">ç‰¹å¤§</option>
      </select>
    </label>
    <label>ç­æ’è¡Œå­—ç´š
      <select id="fsRank">
        <option value="13px">å°</option>
        <option value="14px" selected>ä¸­</option>
        <option value="15px">ä¸­åå¤§</option>
        <option value="16px">å¤§</option>
        <option value="18px">ç‰¹å¤§</option>
      </select>
    </label>
    <label>è€å¸«çš„è©±å­—ç´š
      <select id="fsTeacher">
        <option value="13px">å°</option>
        <option value="14px" selected>ä¸­</option>
        <option value="15px">ä¸­åå¤§</option>
        <option value="16px">å¤§</option>
        <option value="18px">ç‰¹å¤§</option>
      </select>
    </label>

    <!-- ç´™å¼µå°ºå¯¸ï¼ˆA4/B5 åˆ‡æ›ï¼‰ -->
    <label>ç´™å¼µå°ºå¯¸
      <select id="paper">
        <option value="A4" selected>A4 ç›´å¼</option>
        <option value="B5">B5 ç›´å¼</option>
      </select>
    </label>
  </div>

  <div class="btn-row">
    <button onclick="generateReports()">ç”¢ç”Ÿæˆç¸¾å–®</button>
    <button class="btn-secondary" onclick="printAll()">ğŸ–¨ï¸ åˆ—å°æ‰€æœ‰æˆç¸¾å–®</button>
    <button class="btn-clear" onclick="clearAll()">æ¸…ç©º</button>
  </div>
</div>

<div id="output"></div>

<!-- å‹•æ…‹ @page æ¨£å¼ï¼ˆJS æœƒå¯«å…¥ï¼‰ -->
<style id="pageStyle"></style>

<script>
/* ====== å·¥å…· & å¹´ç´šç§‘ç›®è¦å‰‡ ====== */
function formatNumber(n){ const f=parseFloat(n); return Number.isNaN(f)?'':(f%1===0?parseInt(f):f.toFixed(2)); }
function num(v){ const x=parseFloat(v); return Number.isNaN(x)?0:x; }
function isLowerGrade(g){ return g==='ä¸€'||g==='äºŒ'; }
function getSubjectConfig(grade){
  return isLowerGrade(grade)
    ? [{key:'c',label:'åœ‹èª'},{key:'m',label:'æ•¸å­¸'}]
    : [{key:'c',label:'åœ‹èª'},{key:'m',label:'æ•¸å­¸'},{key:'s',label:'è‡ªç„¶'},{key:'so',label:'ç¤¾æœƒ'},{key:'e',label:'è‹±æ–‡'}];
}

/* æ”¯æ´ã€Œå§“åï¼å­¸ç”Ÿï¼nameï¼studentã€ï¼›è‹¥æ²’æœ‰ï¼Œå°±å¾ç¬¬ä¸€ç­†è³‡æ–™æ‰¾ç¬¬ä¸€å€‹ã€Œä¸æ˜¯ç´”æ•¸å­—ã€çš„æ¬„ä½ç•¶å§“å */
function buildHeaderMap(headers, grade, dataFirstRow){
  const map = { name: 0 };

  // 1) å…ˆç”¨æ¨™é¡Œæ‰¾å§“åæ¬„
  headers.forEach((t,idx)=>{
    const title = (t || '').trim();
    const low = title.toLowerCase();
    if (title.includes('å§“å') || title.includes('å­¸ç”Ÿ') || low === 'name' || low === 'student') {
      map.name = idx;
    }
  });

  // 2) ç§‘ç›®æ¬„ä½
  getSubjectConfig(grade).forEach(sub=>{
    headers.forEach((t,idx)=>{
      const title = (t || '').trim();
      if (title.includes(sub.label)) map[sub.key] = idx;
    });
  });

  // 3) è‹¥æ²’æœ‰æ˜ç¢ºå§“åæ¬„ï¼Œå¾ç¬¬ä¸€ç­†è³‡æ–™çŒœï¼šæ‰¾ç¬¬ä¸€å€‹éç´”æ•¸å­—æ¬„
  const isNumeric = (s)=>/^\s*\d+(\.\d+)?\s*$/.test(s || '');
  const hasNameHeader = headers.some(h=>{
    const s = String(h || '');
    const low = s.toLowerCase();
    return s.includes('å§“å') || s.includes('å­¸ç”Ÿ') || low === 'name' || low === 'student';
  });
  if (!hasNameHeader && Array.isArray(dataFirstRow) && dataFirstRow.length){
    let guess = dataFirstRow.findIndex(v => !isNumeric(v));
    if (guess === -1 && dataFirstRow.length > 1) guess = 1; // éƒ½åƒæ•¸å­—å°±é¸ç¬¬2æ¬„
    if (guess >= 0) map.name = guess;
  }

  return map;
}

/* ====== ç”¢ç”Ÿæˆç¸¾å–® ====== */
function generateReports(){
  const branch=document.getElementById("branch").value;
  const schoolYear=document.getElementById("schoolYear").value;
  const grade=document.getElementById("grade").value;
  const semester=document.getElementById("semester").value;
  const examType=document.getElementById("examType").value;
  const comment=document.getElementById("teacherComment").value;
  const topN=parseInt(document.getElementById("targetIndex").value)||5;

  // ç­å¹³å‡
  const subjects=getSubjectConfig(grade);
  const avgRaw=document.getElementById("avgPaste").value.trim().split("\t");
  const avgVals=subjects.map((_,i)=>num(avgRaw[i]||0));
  const avgTotal=avgVals.reduce((a,b)=>a+b,0);
  const avgAverage=subjects.length?avgTotal/subjects.length:0;

  // åŸå§‹è³‡æ–™
  const raw=document.getElementById("rawInput").value.trim();
  if(!raw){ alert("è«‹å…ˆè²¼ä¸Šå…¨ç­æˆç¸¾è³‡æ–™ï¼ˆå«æ¨™é¡Œåˆ—ï¼‰ã€‚"); return; }
  const lines=raw.split("\n").filter(l=>l.trim().length>0);
  if(lines.length<2){ alert("è³‡æ–™ç­†æ•¸ä¸è¶³ï¼Œè«‹ç¢ºèªè‡³å°‘åŒ…å«æ¨™é¡Œåˆ—èˆ‡ä¸€ä½å­¸ç”Ÿè³‡æ–™ã€‚"); return; }

  const headers=lines[0].split("\t");
  const firstData = (lines[1] || "").split("\t");
  const headerMap = buildHeaderMap(headers, grade, firstData);

  const missing=subjects.filter(s=> typeof headerMap[s.key]!=='number').map(s=>s.label);
  if(missing.length){ alert(`æ‰¾ä¸åˆ°å¿…è¦æ¬„ä½ï¼š${missing.join('ã€')}ã€‚\nè«‹ç¢ºèªæ¨™é¡Œåˆ—æ˜¯å¦åŒ…å«é€™äº›æ¬„ä½ã€‚`); return; }

  const students=lines.slice(1).map(l=>l.split("\t"));
  const scoreList=students.map(fields=>{
    const subs=subjects.map(s=>num(fields[headerMap[s.key]]));
    const total=subs.reduce((a,b)=>a+b,0);
    return { name: fields[headerMap.name]||fields[0]||'', raw:fields, scores:subs, total, avg: subjects.length?(total/subjects.length):0 };
  }).sort((a,b)=>b.total-a.total);

  const cutoff=scoreList.length>=topN?scoreList[topN-1].total:0;
  const topStudents=scoreList.filter(stu=>stu.total>=cutoff);

  const output=document.getElementById("output");
  output.innerHTML="";

  scoreList.forEach(student=>{
    // å‰Nåï¼ˆå«ä¸¦åˆ—ï¼‰
    let currentRank=1,lastScore=null,displayRank=1;
    const topRows=topStudents.map(stu=>{
      if(lastScore!==null && stu.total<lastScore){ displayRank=currentRank; }
      lastScore=stu.total; currentRank++;
      const cells=subjects.map((s,idx)=>`<td>${formatNumber(stu.scores[idx])}</td>`).join("");
      return `<tr><td>${displayRank}</td><td>${stu.name}</td>${cells}<td>${formatNumber(stu.total)}</td><td>${formatNumber(stu.avg)}</td></tr>`;
    }).join("");

    const theadCols=['å­¸ç”Ÿ'].concat(subjects.map(s=>s.label)).concat(['ç¸½åˆ†','å¹³å‡']);
    const theadHtml=theadCols.map(t=>`<th>${t}</th>`).join("");
    const personCells=subjects.map((s,idx)=>`<td>${formatNumber(student.scores[idx])}</td>`).join("");
    const avgCells=avgVals.map(v=>`<td>${formatNumber(v)}</td>`).join("");
    const rankHead=['åæ¬¡','å§“å'].concat(subjects.map(s=>s.label)).concat(['ç¸½åˆ†','å¹³å‡']).map(t=>`<th>${t}</th>`).join("");

    const page=`
    <div class="b5">
      <h2 style="text-align:center; margin-bottom:4px; line-height:1.2;">æ­£è¯è³‡å„ªæ•™è‚²å­¸è‹‘ ${branch}åˆ†æ ¡</h2>
      <p style="text-align:center; margin-top:0; line-height:1.2;">${schoolYear}å­¸å¹´${semester}å­¸æœŸ æœŸ${examType}è€ƒ ${grade}å¹´ç´šå­¸ç”Ÿå€‹äººæˆç¸¾å–®</p>

      <table class="personal-table">
        <tr>${theadHtml}</tr>
        <tr>
          <td>${student.name}</td>
          ${personCells}
          <td>${formatNumber(student.total)}</td>
          <td>${formatNumber(student.avg)}</td>
        </tr>
        <tr>
          <td>ç­å¹³å‡</td>
          ${avgCells}
          <td>${formatNumber(avgTotal)}</td>
          <td>${formatNumber(avgAverage)}</td>
        </tr>
      </table>

      <div class="red-title">æ­£è¯ç­æ’å‰${topN}å</div>
      <table class="rank-table">
        <tr>${rankHead}</tr>
        ${topRows}
      </table>

      <p><strong>è€å¸«çš„è©±ï¼š</strong></p>
      <div class="teacher-box">${comment}</div>

      <table class="signature-table" style="width:100%; font-size:10pt; border-collapse:collapse;">
        <tr>
          <td style="width:33%; text-align:left;">ç­ä¸»ä»»ï¼š</td>
          <td style="width:33%; text-align:left;">å°å¸«ï¼š</td>
          <td style="width:33%; text-align:left;">å®¶é•·ç°½åï¼š</td>
        </tr>
      </table>
    </div>`;
    output.innerHTML += page;
  });

  // ç”¢ç”Ÿå¾ŒåŒæ­¥å­—ç´š
  applyFontSizes();
}

/* æ¸…ç©º */
function clearAll(){
  document.getElementById("rawInput").value="";
  document.getElementById("avgPaste").value="";
  document.getElementById("teacherComment").value="";
  document.getElementById("wordCount").innerText="ç›®å‰å­—æ•¸ï¼š0 / å»ºè­°ä¸Šé™ 600";
  document.getElementById("targetIndex").value=5;
  document.getElementById("output").innerHTML="";
}

/* å­—ç´šæ§åˆ¶ï¼ˆå³æ™‚ï¼‰ */
function applyFontSizes(){
  document.documentElement.style.setProperty('--fs-personal', document.getElementById('fsPersonal').value);
  document.documentElement.style.setProperty('--fs-rank', document.getElementById('fsRank').value);
  document.documentElement.style.setProperty('--fs-teacher', document.getElementById('fsTeacher').value);
}

/* ç´™å¼µå°ºå¯¸ï¼ˆA4/B5ï¼‰â€” åŒæ­¥é è¦½å¯¬åº¦èˆ‡ @page */
function applyPaper(){
  const paper = document.getElementById('paper')?.value || 'A4';
  const styleEl = document.getElementById('pageStyle');
  const margin = '10mm'; // ç©©å®šé‚Šç•Œï¼Œé¿å…å°è¡¨æ©Ÿè£åˆ‡

  if (paper === 'B5'){
    document.documentElement.style.setProperty('--sheet-width-mm', '156mm'); // B5 å…§å®¹å¯¬
    styleEl.textContent = `@page{ size:B5 portrait; margin:${margin}; }`;
  }else{
    document.documentElement.style.setProperty('--sheet-width-mm', '190mm'); // A4 å…§å®¹å¯¬
    styleEl.textContent = `@page{ size:A4 portrait; margin:${margin}; }`;
  }
}

/* åˆ—å°æé†’ï¼ˆå…¨åŸŸï¼‰ */
function printAll(){
  alert(
    "åˆ—å°å°æé†’ï¼š\n\n" +
    "1) ã€æ›´å¤šè¨­å®šã€çš„ç´™å¼µå°ºå¯¸è¦èˆ‡é¸å–®ç›¸åŒï¼ˆA4 æˆ– B5ï¼‰ã€‚\n" +
    "2) ç¸®æ”¾æ¯”ä¾‹è«‹è¨­ç‚º 100%ï¼ˆä¸è¦è‡ªå‹•æˆ– 150%ï¼‰ã€‚\n" +
    "3) é‚Šç•Œå»ºè­°é è¨­/æ¨™æº–æˆ–ç´„ 10mmã€‚\n\n" +
    "ç¢ºèªé è¦½æ˜¯ä¸€é ä¸€å¼µæˆç¸¾å–®ï¼Œå†æŒ‰åˆ—å°ã€‚"
  );
  window.print();
}

/* é è¨­å€¼èˆ‡ç›£è½ */
window.addEventListener("DOMContentLoaded",()=>{
  const now=new Date(), y=now.getFullYear(), m=now.getMonth()+1;
  const semesterYear=(m>=8||m===1)?(y-1911):(y-1912);
  const semester=(m>=8||m===1)?"ä¸Š":"ä¸‹";
  let examType="ä¸­";
  if((m>=1&&m<=2)||(m>=5&&m<=6)) examType="æœ«";
  else if((m>=11&&m<=12)||(m>=4&&m<=5)) examType="ä¸­";
  document.getElementById("schoolYear").value=semesterYear;
  document.getElementById("semester").value=semester;
  document.getElementById("examType").value=examType;

  // å­—æ•¸è¨ˆç®—
  const tc=document.getElementById("teacherComment");
  tc.addEventListener("input",()=>{
    const c=tc.value.length;
    const w=document.getElementById("wordCount");
    w.innerText=`ç›®å‰å­—æ•¸ï¼š${c} / å»ºè­°ä¸Šé™ 600`;
    w.style.color=c>600?'red':'#6b7280';
  });

  // ä¸‰å€å­—ç´šå³æ™‚é è¦½
  ['fsPersonal','fsRank','fsTeacher'].forEach(id=>{
    document.getElementById(id).addEventListener('change', applyFontSizes);
  });
  applyFontSizes();

  // ç´™å¼µå°ºå¯¸ï¼šè¼‰å…¥èˆ‡åˆ‡æ›éƒ½å¥—ç”¨
  document.getElementById('paper').addEventListener('change', applyPaper);
  applyPaper();
});
</script>

</body>
</html>
