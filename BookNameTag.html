<!DOCTYPE html>
<html lang="zh-Hant-TW">
<head>
<meta charset="UTF-8" />
<title>è‹±æ–‡æ•™æ å§“åè²¼ ç”¢ç”Ÿå™¨</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
/* ===== é˜²çˆ†æ¬„ ===== */
*,*::before,*::after{ box-sizing:border-box }

/* ===== Tokens ===== */
:root{
  --brand-500:#A1C6EA; --brand-600:#8FB9E2;
  --secondary-500:#BBD1EA; --secondary-600:#A8C5E6;
  --clear-500:#E6EDF0; --clear-600:#D8E3E8;
  --text-strong:#0f172a; --text-normal:#334155; --text-mute:#64748b;
  --border:#d1d5db; --bg-page:#f6f8fb; --bg-card:#ffffff;
  --font-sans:"Microsoft JhengHei","å¾®è»Ÿæ­£é»‘é«”","Noto Sans TC","PingFang TC","Heiti TC",sans-serif;
  --radius-md:12px; --shadow-sm:0 1px 3px rgba(2,6,23,.08); --shadow-md:0 8px 24px rgba(2,6,23,.1);
  --input-height:3.1rem; --btn-height:3.2rem; --focus-ring:0 0 0 3px rgba(106,154,255,.25);
  --cell-h-mm:29.7mm; /* ç”± JS ä¾ç‰ˆå‹æ›´æ–° */
}

/* ===== Base ===== */
html,body{height:100%}
body{
  font-family:var(--font-sans); background:var(--bg-page);
  margin:0; padding:0; display:flex; justify-content:center; align-items:flex-start; min-height:100vh; color:var(--text-normal);
}
.container{ background:#fff; padding:2.2rem 2rem; margin:2rem 1rem; border-radius:16px; box-shadow:var(--shadow-md); max-width:1240px; width:100%;}
h1{margin:0 0 1.25rem; color:#0A57C6; text-align:center; font-weight:900; letter-spacing:.02em;}
.small-muted{font-size:13px;color:var(--text-mute)}

/* ===== å…©æ¬„ï¼ˆFlex ç­‰é«˜ï¼‰ ===== */
.panel{ display:flex; gap:22px; align-items:stretch; }
.left-col{ flex:0 0 48%; min-width:0; display:flex; flex-direction:column; }  /* å·¦ç¨çª„ */
.right-col{ flex:1 1 0;   min-width:0; display:flex; flex-direction:column; }  /* å³ç¨å¯¬ï¼Œè®“ä¸‹æ‹‰å­—ä¸è¢«æˆª */
@media (max-width:1100px){ .panel{ flex-direction:column; } }

/* ===== å¡ç‰‡ ===== */
.card{ background:#fff; border:1px solid var(--border); border-radius:12px; padding:16px; box-shadow:var(--shadow-sm);}
.card + .card{ margin-top:14px; }
.section-title{font-weight:900; color:#0f172a; letter-spacing:.02em;}
.card.flex-1{ display:flex; flex-direction:column; flex:1 1 0; }

/* Step 1 æ¨™é¡Œåˆ—ï¼šæ¨™é¡Œ + èªªæ˜éˆ• ä¸¦æ’ */
.card-head{ display:flex; align-items:center; gap:10px; justify-content:flex-start; margin-bottom:.5rem; }

/* æŒ‰éˆ• */
button{
  display:inline-flex; align-items:center; justify-content:center;
  min-height:var(--btn-height); padding:0 1.1rem;
  font-size:17px; font-weight:900; border:none; border-radius:12px;
  cursor:pointer; color:#0f2740; background:var(--brand-500);
  transition:background .12s, transform .08s, box-shadow .18s;
  box-shadow:var(--shadow-sm);
}
button:hover{background:var(--brand-600); transform:translateY(-1px)}
.btn-secondary{ background:var(--secondary-500); } .btn-secondary:hover{ background:var(--secondary-600); }
.btn-clear{ background:var(--clear-500); }     .btn-clear:hover{ background:var(--clear-600); }
.btn-sm{ min-height:2.3rem; padding:0 .9rem; font-size:14px; }

/* è¡¨å–® */
textarea, input, select{
  width:100%; max-width:100%;
  height:var(--input-height);
  padding:0 1rem; border-radius:12px; border:1px solid var(--border);
  font-size:16px; background:#f9fafb;
  transition:border-color .18s, box-shadow .18s, background-color .18s;
}
textarea{
  height:auto; min-height:330px; resize:vertical; padding:1rem; line-height:1.6;
  font-family:ui-monospace,Menlo,Consolas,monospace; background:#fff;
  flex:1;
}
textarea:focus, input:focus, select:focus{outline:none; border-color:#6a9aff!important; box-shadow:var(--focus-ring); background:#eef6ff;}
select:hover{background:#f1f5f9; border-color:#a1c6ea}

/* å³å´å…©æ¬„åˆ— */
.row-2{ display:grid; grid-template-columns:minmax(0,1fr) minmax(0,1fr); gap:12px; }

/* Step 4 æŒ‰éˆ•åˆ—ï¼ˆä¸åŒ…å¡ç‰‡ï¼›å¸é™„åœ¨å³æ¬„åº•éƒ¨ï¼‰ */
.actions-bar{
  margin-top:14px;
  display:grid; grid-template-columns:repeat(3, minmax(0,1fr)); gap:12px;
  margin-left:auto; margin-right:auto; width:100%;
}
@media (max-width:680px){ .actions-bar{ grid-template-columns:repeat(2, minmax(0,1fr)); } }
@media (max-width:420px){ .actions-bar{ grid-template-columns:1fr; } }

/* ===== é è¦½ ===== */
#previewWrap{margin-top:18px; border:1px solid #e5e7eb; border-radius:12px; padding:12px; background:#fff; position:relative;}
.sheet{width:calc(4 * 52.5mm); margin:0 auto 14px;}
.grid{display:grid; grid-template-columns:repeat(4, 52.5mm); gap:0;}
.label{width:52.5mm; height:var(--cell-h-mm); display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; padding:0 6mm; border:0.25pt dotted #d0d0d0; background:#fff;}
.class-code{font-size:24px; font-weight:900; letter-spacing:2px; margin-bottom:2px; text-decoration:underline;}
.student-name{font-size:24px; font-weight:700; white-space:nowrap;}
.toast{position:sticky; top:8px; float:right; margin-left:auto; background:#0f2740; color:#fff; padding:.5rem .75rem; border-radius:999px; font-size:14px; font-weight:800; box-shadow:var(--shadow-sm); opacity:0; transform:translateY(-6px); transition:opacity .18s, transform .18s; z-index:10; width:max-content;}
.toast.show{opacity:1; transform:translateY(0)}
@keyframes flashPulse{0%{box-shadow:0 0 0 0 rgba(161,198,234,0); background:#fff; border-color:#e5e7eb;} 30%{box-shadow:0 0 0 6px rgba(161,198,234,.35); background:#f4f9ff; border-color:#8FB9E2;} 100%{box-shadow:0 0 0 0 rgba(161,198,234,0); background:#fff; border-color:#e5e7eb;}}
.preview-flash{animation:flashPulse .6s ease-out 1;}
@media print{ @page{size:A4;margin:0} .container > *:not(#previewWrap){display:none!important;} #previewWrap{border:none; padding:0; box-shadow:none;} }
</style>
</head>
<body>
  <div class="container">
    <h1>è‹±æ–‡æ•™æ å§“åè²¼ ç”¢ç”Ÿå™¨</h1>

    <div class="panel">
      <!-- å·¦æ¬„ï¼ˆç¨çª„ï¼‰ -->
      <div class="left-col">
        <div class="card flex-1">
          <div class="card-head">
            <div class="section-title">Step 1ï¼å¾é»åè¡¨è²¼ä¸Šè³‡æ–™</div>
            <button id="toggleHelp" class="btn-secondary btn-sm">è²¼ä¸Šè³‡æ–™çš„èªªæ˜</button>
          </div>

          <!-- èªªæ˜å€å¡Šæ¬åˆ°ä¸Šæ–¹ï¼ˆå±•é–‹æ™‚æŠŠè¼¸å…¥æ¡†å¾€ä¸‹æ¨ï¼‰ -->
          <div class="instructions-content" id="helpBox" style="display:none; margin-bottom:.8rem; background:#f8fbff; border:1px solid #e1eefc; border-left:5px solid var(--secondary-500); border-radius:10px; padding:1em 1.2em; color:#1b3a57; line-height:1.6;">
            <ul>
              <li><b>æ°¸å¹³ã€æ¸…æ°´</b>ï¼šè²¼ä¸Šã€Œ<b>ä¸­æ–‡å§“å</b>ã€ã€Œ<b>è‹±æ–‡å§“å</b>ã€å…©æ¬„ã€‚<br>
                <pre style="background:#fff;border:1px solid #e6edf7;border-radius:8px;padding:.6em .8em;white-space:pre-wrap;margin:.4em 0;">å¼µå°é£›    FLY</pre>
              </li>
              <li><b>æ±Ÿç¿ </b>ï¼šè²¼ä¸Šã€Œ<b>ä¸­è‹±å§“å</b>ã€æ¬„ï¼ˆä¸­æ–‡åœ¨ä¸Šä¸€è¡Œã€è‹±æ–‡åœ¨ä¸‹ä¸€è¡Œï¼‰ã€‚<br>
                <pre style="background:#fff;border:1px solid #e6edf7;border-radius:8px;padding:.6em .8em;white-space:pre-wrap;margin:.4em 0;">å¼µå°é£›
FLY</pre>
              </li>
            </ul>
          </div>

          <!-- è³‡æ–™è¼¸å…¥æ¡†ï¼ˆåœ¨ä¸‹æ–¹ï¼‰ -->
          <textarea id="raw" placeholder="ä¾‹ï¼š
å¼µå°é£›    FLY
ï¼ˆæˆ–ï¼‰
&quot;å¼µå°é£›
FLY&quot;"></textarea>
        </div>
      </div>

      <!-- å³æ¬„ï¼ˆç¨å¯¬ï¼‰ -->
      <div class="right-col">
        <div class="card">
          <div class="section-title">Step 2ï¼é¸æ“‡ç‰ˆå‹ï¼ˆA4 æ»¿ç‰ˆï¼‰</div>
          <div class="row-2">
            <div>
              <label>ç‰ˆå‹</label>
              <select id="layoutSelect">
                 <option value="4x9">4Ã—9ï¼ˆæ¯é  36 å¼µï¼›é«˜ 3.27 cmï¼‰</option>
                 <option value="4x10" selected>4Ã—10ï¼ˆæ¯é  40 å¼µï¼›é«˜ 2.94 cmï¼‰</option>
              </select>
              <div class="small-muted" id="layoutHint">ç›®å‰ï¼š4Ã—10ï¼ˆæ¯æ ¼ 2.94cmï¼‰</div>
            </div>
            <div>
              <label>æ¯äººå¹¾æ’è²¼ç´™ï¼ˆ4 å¼µä¸€æ’ï¼‰</label>
              <select id="rowsPerStudent">
                <option value="2" selected>4Ã—2ï¼ˆæ¯äºº 8 å¼µï¼‰</option>
                <option value="3">4Ã—3ï¼ˆæ¯äºº 12 å¼µï¼‰</option>
              </select>
              <div class="small-muted" id="rowsHint">ç›®å‰ï¼šæ¯äºº 8 å¼µ</div>
            </div>
          </div>
        </div>

        <!-- Step 3ï¼å…§å®¹èˆ‡å­—ç´š -->
        <div class="card flex-1">
          <div class="section-title">Step 3ï¼å…§å®¹èˆ‡å­—ç´š</div>

          <!-- ç¬¬ 1 æ’ï¼šå·¦=ç­ç´šä»£ç¢¼ã€å³=ç­ç´šå­—ç´š -->
          <div class="row-2">
             <div>
             <label>è‹±æ–‡ç­ç´šä»£ç¢¼</label>
             <input id="commonClass" type="text" placeholder="ä¾‹å¦‚ï¼šTA æˆ– YQA">
             </div>
             <div>
             <label>ç­ç´šå­—ç´šï¼ˆpxï¼‰</label>
             <input id="codeSize" type="number" value="21">  <!-- 21px â‰ˆ 16pt -->
             </div>
          </div>

          <!-- ç¬¬ 2 æ’ï¼šå·¦=ç©ºç™½å ä½ã€å³=å§“åå­—ç´šï¼ˆèˆ‡ä¸Šé¢çš„ç­ç´šå­—ç´šå‚ç›´å°é½Šï¼‰ -->
          <div class="row-2" style="margin-top:12px">
             <div class="spacer"></div>
                 <div>
                 <label>å§“åå­—ç´šï¼ˆpxï¼‰</label>
                 <input id="nameSize" type="number" value="19">  <!-- 19px â‰ˆ 14pt -->
                 </div>
          </div>

          <!-- Step 4ï¼šåº•éƒ¨æŒ‰éˆ•åˆ—ï¼ˆä¿æŒåŸ JS åŠŸèƒ½ï¼‰ -->
          <div class="actions-bar" style="margin-top:20px">
              <button id="gen">ç”¢ç”Ÿæ¨™ç±¤</button>
              <button class="btn-secondary" id="copyHtml">è¤‡è£½åˆ° Word</button>
              <button class="btn-clear" id="clear">æ¸…ç©º</button>
          </div>
       </div>

      </div>
    </div>

    <div id="previewWrap">
      <div id="pages"></div>
      <div id="toast" class="toast" aria-live="polite"></div>
    </div>
  </div>

<script>
/* ---------- èªªæ˜æ”¶åˆ ---------- */
document.getElementById('toggleHelp').addEventListener('click', ()=>{
  const box=document.getElementById('helpBox');
  box.style.display = box.style.display==='block' ? 'none' : 'block';
});

/* ========== DOM ========= */
const pages=document.getElementById('pages');
const layoutSel=document.getElementById('layoutSelect');
const layoutHintEl=document.getElementById('layoutHint');
const rowsSel=document.getElementById('rowsPerStudent');
const nameSizeEl=document.getElementById('nameSize');
const codeSizeEl=document.getElementById('codeSize');
const rawEl=document.getElementById('raw');
const commonClassEl=document.getElementById('commonClass');
const rowsHintEl=document.getElementById('rowsHint');
const toastEl=document.getElementById('toast');
const previewWrap=document.getElementById('previewWrap');

/* å°å·¥å…·ï¼šToast */
let toastTimer=null;
function showToast(msg){
  toastEl.textContent=msg;
  toastEl.classList.add('show');
  clearTimeout(toastTimer);
  toastTimer=setTimeout(()=>toastEl.classList.remove('show'),1500);
}

/* ç‰ˆå‹è¨­å®šï¼ˆé«˜åº¦ï¼š4Ã—10=2.94cmï¼›4Ã—9=3.27cmï¼‰ */
function getLayoutConfig(){
  const v = layoutSel.value;
  const cellH = (v==='4x10') ? '2.94cm' : '3.27cm';
  const rowsPerPage = (v==='4x10') ? 10 : 9;
  const hint = `ç›®å‰ï¼š${v==='4x10'?'4Ã—10':'4Ã—9'}ï¼ˆæ¯æ ¼ ${cellH}ï¼‰`;
  return { rowsPerPage, cellH, hint };
}

/* è§£æè¼¸å…¥ï¼ˆæ”¯æ´ å…©æ¬„/å¼•è™Ÿé›™è¡Œ/æ¯è¡Œæˆå°ï¼‰ */
function parseQuotedPairs(raw){
  const list=[]; const re=/"([\s\S]*?)"/g; let m;
  while((m=re.exec(raw))!==null){
    const block=m[1].replace(/\r/g,'').trim();
    if(!block) continue;
    const parts=block.split(/\n+/).map(s=>s.trim()).filter(Boolean);
    if(parts.length>=2) list.push({cls:'', zh:parts[0], en:parts[1]});
  }
  return list;
}
function looksLikeHeader(cells){
  const s=cells.join(' ').toLowerCase();
  return /(chinese|english|name|ä¸­æ–‡|è‹±æ–‡)/.test(s);
}
function parseLine(line){
  if(!line) return null;
  line=line.replace(/\u3000/g,' ').trim();
  const cells=line.split(/\t|,| {2,}/).map(s=>s.trim()).filter(Boolean);
  if(!cells.length) return null;
  if(looksLikeHeader(cells)) return null;
  if(cells.length===2) return {cls:'', zh:cells[0], en:cells[1]};
  if(cells.length>=3) return {cls:cells[0], zh:cells[1], en:cells[2]};
  return null;
}
function parseInput(raw){
  const q=parseQuotedPairs(raw);
  if(q.length) return q;
  const lines=raw.replace(/\r/g,'').split('\n').map(s=>s.trim()).filter(Boolean);
  const recs=[]; const leftovers=[];
  for(const line of lines){
    const r=parseLine(line);
    if(r) recs.push(r); else leftovers.push(line);
  }
  for(let i=0;i+1<leftovers.length;i+=2){
    recs.push({cls:'', zh:leftovers[i], en:leftovers[i+1]});
  }
  return recs;
}

/* åŒä¸€äººé€£çºŒ N æ’ï¼ˆN=2/3ï¼‰ï¼Œè¨ˆç®—æŸé  items */
function buildPageItemsByVerticalRows(recs, rowsPerStudent, pageIndex, rowsPerPage){
  const PER_ROW = 4;
  const CELLS_PER_PAGE = PER_ROW * rowsPerPage;
  const labelsPerStudent = rowsPerStudent * PER_ROW;
  const startStudent = Math.floor(pageIndex * CELLS_PER_PAGE / labelsPerStudent);
  const startOffset  = (pageIndex * CELLS_PER_PAGE) % labelsPerStudent;

  const out = [];
  let sIdx = startStudent, offset = startOffset;

  while(out.length < CELLS_PER_PAGE){
    const stu = recs[sIdx];
    if(!stu) break;
    const startRowOfThisStu = Math.floor(offset / PER_ROW);
    for(let r = startRowOfThisStu; r < rowsPerStudent && out.length < CELLS_PER_PAGE; r++){
      for(let c = 0; c < PER_ROW && out.length < CELLS_PER_PAGE; c++) out.push(stu);
    }
    sIdx++; offset = 0;
  }
  while(out.length < CELLS_PER_PAGE) out.push(null);
  return out;
}

/* é è¦½ï¼ˆèˆ‡ Word æ’ç‰ˆä¸€è‡´ï¼‰ */
function buildPreview(){
  const recs=parseInput(rawEl.value);
  const common=(commonClassEl.value||'').trim();
  if(common) recs.forEach(r=>r.cls=common);

  const rowsPerStudent=+rowsSel.value||2;
  const {rowsPerPage,cellH,hint}=getLayoutConfig();
  layoutHintEl.textContent=hint;
  document.documentElement.style.setProperty('--cell-h-mm',cellH);

  const PER_PAGE=rowsPerPage*4;
  pages.innerHTML='';
  const totalCells=recs.length*(rowsPerStudent*4);
  const totalPages=Math.max(1,Math.ceil(totalCells/PER_PAGE));

  for(let p=0;p<totalPages;p++){
    const sheet=document.createElement('div'); sheet.className='sheet';
    const grid=document.createElement('div');  grid.className='grid';
    const items = buildPageItemsByVerticalRows(recs, rowsPerStudent, p, rowsPerPage);
    for(let i=0;i<PER_PAGE;i++){
      const it = items[i];
      const cell=document.createElement('div'); cell.className='label';
      if(it){
        cell.innerHTML=`<div class='class-code'>${it.cls||''}</div><div class='student-name'>${it.zh} ${it.en}</div>`;
      }
      grid.appendChild(cell);
    }
    sheet.appendChild(grid);
    pages.appendChild(sheet);
  }
  applyStyles();
}
function applyStyles(){
  const namePx=+nameSizeEl.value||19;
  const codePx=+codeSizeEl.value||21;
  document.querySelectorAll('.student-name').forEach(e=>e.style.fontSize=namePx+'px');
  document.querySelectorAll('.class-code').forEach(e=>e.style.fontSize=codePx+'px');
}

/* Word HTMLï¼ˆå«æ ¼å¼ï¼Œå›ºå®šé«˜åº¦é¿å…æ’é«˜ï¼‰ */
function buildWordHTML(){
  const recs = parseInput(rawEl.value);
  const common = (commonClassEl.value || '').trim();
  if(common) recs.forEach(r => r.cls = common);

  const rowsPerStudent = +rowsSel.value || 2;
  const { rowsPerPage, cellH } = getLayoutConfig();

  const namePt = (+nameSizeEl.value || 19) * 0.75;  // px -> pt
  const codePt = (+codeSizeEl.value || 21) * 0.75;

  const CELL_W = '52.5mm';
  const PER_PAGE = rowsPerPage * 4;
  const totalCells = recs.length * (rowsPerStudent * 4);
  const totalPages = Math.max(1, Math.ceil(totalCells / PER_PAGE));

  const cellStyle =
    `width:${CELL_W};height:${cellH};vertical-align:middle;text-align:center;`+
    `padding:0 6mm;box-sizing:border-box;border:0.25pt dotted #d0d0d0;`+
    `background:transparent;mso-line-height-rule:exactly;mso-padding-alt:0cm 6mm 0cm 6mm;`;
  const codeStyle = `font-size:${codePt}pt;font-weight:900;line-height:1.2;text-decoration:underline;`;
  const nameStyle = `font-size:${namePt}pt;font-weight:bold;line-height:1.22;`;

  let body = '';
  for(let p=0; p<totalPages; p++){
    const items = buildPageItemsByVerticalRows(recs, rowsPerStudent, p, rowsPerPage);
    body += `<table style="border-collapse:collapse;table-layout:fixed;width:calc(4*${CELL_W});mso-table-lspace:0pt;mso-table-rspace:0pt;mso-table-layout-alt:fixed;mso-table-overlap:never;mso-cellspacing:0;">`;
    for(let r=0; r<rowsPerPage; r++){
      body += '<tr>';
      for(let c=0; c<4; c++){
        const it = items[r*4 + c];
        const inner = it ? `<div style="${codeStyle}">${it.cls || ''}</div><div style="${nameStyle}">${it.zh} ${it.en}</div>` : '';
        body += `<td style="${cellStyle}">${inner}</td>`;
      }
      body += '</tr>';
    }
    body += '</table>';
    if(p !== totalPages-1) body += '<div style="page-break-after:always;"></div>';
  }

  return `<!doctype html>
<html><head><meta charset="UTF-8">
<style>@page{size:A4;margin:0} body,td,div{font-family:"Microsoft JhengHei","å¾®è»Ÿæ­£é»‘é«”","Noto Sans TC","PingFang TC","Heiti TC",sans-serif} table{border-collapse:collapse}</style>
</head><body>${body}</body></html>`;
}

/* äº‹ä»¶ï¼ˆåªæœ‰ã€Œæ¯äººå¹¾æ’ã€æœƒè‡ªå‹•æ²å‹•ï¼‰ */
layoutSel.addEventListener('change', ()=>{ buildPreview(); showToast('ç‰ˆå‹å·²åˆ‡æ›'); });

rowsSel.addEventListener('change', ()=>{
  buildPreview();
  const perPerson = (+rowsSel.value || 2) * 4;
  rowsHintEl.textContent = `ç›®å‰ï¼šæ¯äºº ${perPerson} å¼µ`;
  showToast(`æ¯äºº ${perPerson} å¼µ`);
  previewWrap.classList.add('preview-flash');
  previewWrap.scrollIntoView({ behavior:'smooth', block:'start' });
  setTimeout(()=>previewWrap.classList.remove('preview-flash'),650);
});

commonClassEl.addEventListener('input', ()=>{ buildPreview(); showToast('ğŸ“˜ ç­ç´šä»£ç¢¼å·²å¥—ç”¨'); });
nameSizeEl.addEventListener('input', ()=>{ applyStyles(); showToast('Aa å§“åå­—ç´šå·²æ›´æ–°'); });
codeSizeEl.addEventListener('input', ()=>{ applyStyles(); showToast('ğŸ· ç­ç´šå­—ç´šå·²æ›´æ–°'); });

document.getElementById('gen').addEventListener('click', buildPreview);

document.getElementById('copyHtml').addEventListener('click', async ()=>{
  const html = buildWordHTML();
  if(navigator.clipboard && window.ClipboardItem){
    try{
      const blob = new Blob([html], { type:'text/html' });
      await navigator.clipboard.write([new ClipboardItem({ 'text/html': blob })]);
      showToast('âœ… å·²è¤‡è£½ï¼ˆå«æ ¼å¼ï¼‰ã€‚åˆ° Word é¸å– 4Ã—N å€å¡Šå¾Œè²¼ä¸Šå³å¯ã€‚');
      return;
    }catch(e){}
  }
  const box=document.createElement('div');
  box.contentEditable='true'; box.style.position='fixed'; box.style.left='-9999px'; box.innerHTML=html;
  document.body.appendChild(box);
  const range=document.createRange(); range.selectNodeContents(box);
  const sel=window.getSelection(); sel.removeAllRanges(); sel.addRange(range);
  const ok=document.execCommand('copy'); sel.removeAllRanges(); document.body.removeChild(box);
  showToast(ok ? 'âœ… å·²è¤‡è£½ï¼ˆå«æ ¼å¼ï¼‰ã€‚åˆ° Word å…¨é¸è²¼ä¸Šå³å¯ã€‚' : 'âš ï¸ è¤‡è£½å¤±æ•—ï¼Œè«‹å†è©¦ä¸€æ¬¡æˆ–æ”¹ç”¨æ–°ç‰ˆç€è¦½å™¨ã€‚');
});

document.getElementById('clear').addEventListener('click', ()=>{
  rawEl.value=''; commonClassEl.value=''; pages.innerHTML=''; showToast('å·²æ¸…ç©º');
});

/* åˆå§‹ */
buildPreview();
</script>
</body>
</html>
