
<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>å‡åˆ¥çµ±è¨ˆå·¥å…·</title>
     <style>
     body {
     font-family: "Segoe UI", "å¾®è»Ÿæ­£é»‘é«”", sans-serif;
     background-color:#D4DCDB;
     padding: 1.5em;
     color: #333;
     }

     label {
     margin-right: 0.5em;
     }

     button {
     padding: 0.5em 1em;
     background-color: #3c82f6;
     border: none;
     color: white;
     border-radius: 6px;
     font-size: 1em;
     cursor: pointer;
     margin-left: 1em;
     }

     button:hover {
     background-color: #2563eb;
    }

     table {  
     table-layout: fixed;
     width: 80%;/*æ”¹å¯¬åº¦*/
     border-collapse: collapse;
     margin-top: 1.5em;
     background-color: white;
     box-shadow: 0 2px 8px rgba(0,0,0,0.05);
     }

  th, td {
    border: 1px solid #ddd;
    padding: 0.6em;
    text-align: center;
  }

  th {
    background-color: #f0f4f8;
    font-weight: 600;
    position: sticky;
    top: 0;
    z-index: 1;
  }

  tr.sunday {
    background-color: #ffe5e5;
  }

  tr.saturday {
    background-color: #e5f0ff;
  }

  input[type="checkbox"] {
    transform: scale(1.3);
    
  }

  input[type="text"] {
    width: 6em;
    padding: 0.3em;
    margin-right: 1em;
    border: 1px solid #ccc;
    border-radius: 4px;
  }

  input[type="number"] {
    width: 4em;
    padding: 0.2em;
    text-align: center;
    border: 1px solid #ccc;
    border-radius: 4px;
    margin-right: 1em;
  }


  /* æ¯æ¬„å¯¬åº¦è¨­å®š */
  table th:nth-child(1), table td:nth-child(1) { width: 20px; } /*æ—¥æœŸ*/
  table th:nth-child(2), table td:nth-child(2) { width: 20px; } /*æ˜ŸæœŸ*/
  table th:nth-child(3), table td:nth-child(3) { width: 30px; } /*ç‰¹ä¼‘(å¤©)*/
  table th:nth-child(4), table td:nth-child(4) { width: 50px; } /*ç‰¹ä¼‘(æ™‚)*/
  table th:nth-child(5), table td:nth-child(5) { width: 30px; } /*äº‹å‡(å¤©)*/
  table th:nth-child(6), table td:nth-child(6) { width: 50px; } /*äº‹å‡(æ™‚)*/
  table th:nth-child(7), table td:nth-child(7) { width: 30px; } /*ç—…å‡(å¤©)*/
  table th:nth-child(8), table td:nth-child(8) { width: 50px; } /*ç—…å‡(æ™‚)*/
  table th:nth-child(9), table td:nth-child(9) { width: 50px; } /*é²åˆ°æ‰£*/
  table th:nth-child(10), table td:nth-child(10) { width: 50px; } /*é²åˆ°ä¸æ‰£*/
  table th:nth-child(11), table td:nth-child(11) { width: 50px; } /*æ¼æ‰“å¡*/
  table th:nth-child(12), table td:nth-child(12) { width: 50px; } /*ç”Ÿç†å‡*/
  table th:nth-child(13), table td:nth-child(13) { width: 30px; } /*å–ªå‡(å¤©)*/
  table th:nth-child(14), table td:nth-child(14) { width: 50px; } /*å–ªå‡(æ™‚)*/
  table th:nth-child(15), table td:nth-child(15) { width: 50px; } /*è¶…æ™‚(æ™‚)*/


  
  .totals {
    margin-top: 20px;
    white-space: pre-wrap;
    background-color: #f9f9f9;
    padding: 10px;
    border: 1px dashed #ccc;
  }

  .weekend {
    font-weight: bold;
  }

  .saturday {
    background-color: #e6f7ff;
  }

  .sunday {
    background-color: #ffe6e6;
  }

  tr.weekend-row:hover {
    background-color: #A29093;
  }

  .import-button {
    margin-top: 10px;
    padding: 8px 15px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }

  .import-button:hover {
    background-color: #45a049;
  }

  .date-input {
    width: 80px;
    margin-top: 5px;
  }

  .checkbox-group {
    display: flex;
    align-items: center; /* æ°´å¹³å°é½Š */
    gap: 4px; /* èª¿æ•´é–“è· */
    flex-wrap: wrap;
    max-width: 150px;
    
  }
  
  #punchCardMissColumn {
    width: 100px;
    white-space: nowrap;
  }
 </style>

</head>
<body>
    <h2>å‡åˆ¥ç™»è¨˜èˆ‡çµ±è¨ˆå·¥å…·</h2>
    <label>è€å¸«å§“åï¼ˆå¯ç•™ç©ºï¼‰ï¼š<input type="text" id="teacherNameLeave" style="width: 100px" placeholder="ä¾‹å¦‚ï¼šå¼µæ­£è¯"></label><br>
    <label>å¹´ä»½ï¼š<input type="number" id="yearInput" value="" min="2000" max="2100"></label>
    <label>æœˆä»½ï¼ˆ1~12ï¼‰ï¼š<input type="number" id="monthInput" value="5" min="1" max="12"></label>
    <button onclick="generateTable()">ç”¢ç”Ÿæ—¥æœŸè¡¨</button>

    <div id="formArea"></div>
    <button onclick="calculateLeave()">çµ±è¨ˆçµæœ</button>

    <h3>çµ±è¨ˆçµæœï¼ˆå¯è¤‡è£½ï¼‰ï¼š</h3>
    <button onclick="copyResultsLeave()">ğŸ“‹ è¤‡è£½çµæœ</button>
    <div class="totals" id="resultsLeave" contenteditable="true"></div>
    <button class="import-button" onclick="importLeaveResults()">â” åŒ¯å…¥ä¸è¨ˆè–ªè¨ˆç®—</button>

    <hr>

    <h2>äº‹ç—…å‡ æˆ– é²åˆ° ä¸è¨ˆè–ªè¨ˆç®—å™¨</h2>

    <label>è€å¸«å§“åï¼ˆå¯ç•™ç©ºï¼‰ï¼š</label>
    <input type="text" id="nameSalary" style="width: 100px" placeholder="ä¾‹å¦‚ï¼šå¼µæ­£è¯"><br>

    <label>åŸå§‹æœˆè–ªï¼š</label>
    <input type="number" id="salary" style="width: 100px;" placeholder="ä¾‹å¦‚ï¼š32000"><br>

    <label>äº‹å‡ï¼ˆå¤©ï¼‰ï¼š</label>
    <input type="number" id="leaveDaysSalary" style="width: 60px" placeholder="0">

    <label>äº‹å‡ï¼ˆå°æ™‚ï¼‰ï¼š</label>
    <input type="number" id="leaveHoursSalary" style="width: 60px" placeholder="0"><br>

    <label>ç—…å‡ï¼ˆå¤©ï¼‰ï¼š</label>
    <input type="number" id="sickDaysSalary" style="width: 60px" placeholder="0">

    <label>ç—…å‡ï¼ˆå°æ™‚ï¼‰ï¼š</label>
    <input type="number" id="sickHoursSalary" style="width: 60px" placeholder="0"><br>

    <label>ç”Ÿç†å‡ï¼ˆå°æ™‚ï¼‰ï¼š</label>
    <input type="number" id="menstrualHoursSalary" style="width: 60px" placeholder="0"><br>

    <label>è¶…éä¸‰æ¬¡5åˆ†é˜çš„é²åˆ°ï¼ˆåˆ†é˜ï¼‰ï¼š</label>
    <input type="number" id="lateMinutesSalary" style="width: 60px" placeholder="0"><br>

    <button onclick="calculateSalaryDeduction()">è¨ˆç®—ä¸æ”¯è–ª</button><br><br>
    <div id="salaryResult"></div>
    <button onclick="copyResultsSalary()">ğŸ“‹ è¤‡è£½ç®—å¼</button>

    <script>
     document.getElementById("yearInput").value = new Date().getFullYear();

     function generateTable() {
        const year = parseInt(document.getElementById("yearInput").value);
        const month = parseInt(document.getElementById("monthInput").value);
        const daysInMonth = new Date(year, month, 0).getDate();

        let html = '<table><tr><th>æ—¥æœŸ</th><th>æ˜ŸæœŸ</th><th>ç‰¹ä¼‘<br>è£œä¼‘<br>(å¤©)</th><th>ç‰¹ä¼‘<br>è£œä¼‘<br>(æ™‚)</th><th>äº‹å‡<br>(å¤©)</th><th>äº‹å‡<br>(æ™‚)</th><th>ç—…å‡<br>(å¤©)</th><th>ç—…å‡<br>(æ™‚)</th><th>é²åˆ°æ‰£<br>(åˆ†é˜)</th><th>é²åˆ°ä¸‰æ¬¡äº”åˆ†é˜å…§<br>(åˆ†é˜)</th><th id="punchCardMissColumn">æ¼æ‰“å¡</th><th>ç”Ÿç†å‡<br>(æ™‚)</th><th>å–ªå‡<br>(å¤©)</th><th>å–ªå‡<br>(æ™‚)</th><th>è¶…æ™‚<br>(æ™‚)</th></tr>';

        const weekDays = ["æ—¥", "ä¸€", "äºŒ", "ä¸‰", "å››", "äº”", "å…­"];

        for (let day = 1; day <= daysInMonth; day++) {
            const date = new Date(year, month - 1, day);
            const displayDate = `${month}/${day}`;
            const dayOfWeek = date.getDay();

            let weekendClass = "";
            if (dayOfWeek === 6) weekendClass = "saturday";
            else if (dayOfWeek === 0) weekendClass = "sunday";

            html += `<tr class="weekend-row ${weekendClass}">
            <td>${displayDate}</td>
            <td>(${weekDays[dayOfWeek]})</td>
            <td>
            <input type="checkbox" name="leave-v" data-type="v-day" value="1">
            <input type="hidden" name="leave-v-date" value="${displayDate}">
            </td>
            <td><input type="number" name="leave-v" data-type="v-hour" onchange="validateInput(this)">
            <input type="hidden" name="leave-v-date" value="${displayDate}">
            </td>
            <td>
            <input type="checkbox" name="leave-p" data-type="p-day" value="1">
            <input type="hidden" name="leave-p-date" value="${displayDate}">
            </td>
            <td>
            <input type="number" name="leave-p" data-type="p-hour" onchange="validateInput(this)">
            <input type="hidden" name="leave-p-date" value="${displayDate}">
            </td>
            <td>
            <input type="checkbox" name="leave-s" data-type="s-day" value="1">
            <input type="hidden" name="leave-s-date" value="${displayDate}">
            </td>
            <td>
            <input type="number" name="leave-s" data-type="s-hour" onchange="validateInput(this)">
            <input type="hidden" name="leave-s-date" value="${displayDate}">
            </td>
            <td>
            <input type="number" name="late" data-type="late-min" onchange="validateInput(this)">
            <input type="hidden" name="late-date" value="${displayDate}">
            </td>
            <td>
            <input type="number" name="late-no-deduct" data-type="late-no-deduct-min" onchange="validateInput(this)">
            <input type="hidden" name="late-no-deduct-date" value="${displayDate}">
            </td>
            <td>
            <div class="checkbox-group">
            <label><input type="checkbox" name="punch-card-miss" data-type="punch-in" data-date="${displayDate}">ä¸Šç­</label>
            <label><input type="checkbox" name="punch-card-miss" data-type="punch-out" data-date="${displayDate}">ä¸‹ç­</label>
            </div>
            </td>
            <td><input type="number" name="leave-m" data-type="m-hour" onchange="validateInput(this)">
            <input type="hidden" name="leave-m-date" value="${displayDate}">
            </td>
            <td>
            <input type="checkbox" name="leave-f" data-type="f-day" value="1">
            <input type="hidden" name="leave-f-date" value="${displayDate}">
            </td>
            <td>
            <input type="number" name="leave-f" data-type="f-hour" onchange="validateInput(this)">
            <input type="hidden" name="leave-f-date" value="${displayDate}">
            </td>
            <td>
            <input type="number" name="overtime" data-type="overtime-hour" onchange="validateInput(this)">
            <input type="hidden" name="overtime-date" value="${displayDate}">
            </td>            
            </tr>`;
        }

        html += '</table>';
        document.getElementById("formArea").innerHTML = html;
        document.getElementById("resultsLeave").innerText = '';
     }

     function validateInput(input) {
        let value = parseFloat(input.value) || 0;

        if (value < 0) {
            alert("æ•¸å€¼ä¸èƒ½æ˜¯è² æ•¸ï¼");
            input.value = 0;
            return;
        }
     const dataType = input.getAttribute("data-type");
        if (dataType.includes("day") && value > 1) {
            alert("å‡åˆ¥ï¼ˆå¤©ï¼‰ä¸èƒ½è¶…é 1 å¤©ï¼");
            input.value = 1;
     }
        if (dataType.includes("hour") && value > 8) {
            alert("æ¯æ ¼æœ€å¤šå¡«å¯« 8 å°æ™‚ï¼");
            input.value = 8;
        }
     }

     function calculateLeave() {
        const rows = document.querySelectorAll("#formArea table tr:not(:first-child)");
        leaveRecords = [];// äº‹å‡è¨˜éŒ„
        sickRecords = [];// ç—…å‡è¨˜éŒ„
        lateRecords = [];// é²åˆ°è¦æ‰£è¨˜éŒ„
        lateNoDeductRecords = [];// é²åˆ°ä¸æ‰£è¨˜éŒ„
        punchCardMissRecords = [];// æœªæ‰“å¡è¨˜éŒ„
        menstrualRecords = [];// è¨˜éŒ„
        vacationRecords = [];// è¨˜éŒ„
        funeralRecords = []; // å–ªå‡è¨˜éŒ„
        overtimeRecords = []; // è¶…æ™‚è¨˜éŒ„
        
        let vDay = 0, vHour = 0, pDay = 0, pHour = 0, sDay = 0, sHour = 0, lateMin = 0, lateNoDeductMin = 0;
        let punchInCount = 0, punchOutCount = 0;
        let mHour = 0;
        let fDay = 0, fHour = 0; // æ–°å¢å–ªå‡å¤©ã€æ™‚
        let otHour = 0; // æ–°å¢è¶…æ™‚æ™‚
        
        rows.forEach(row => {
            const date = row.querySelector("td:first-child").innerText;
            const inputs = row.querySelectorAll("input");
            const vDateInput = row.querySelectorAll("input[type='hidden'][name$='-v-date']");
            const pDateInput = row.querySelectorAll("input[type='hidden'][name$='-p-date']");
            const sDateInput = row.querySelectorAll("input[type='hidden'][name$='-s-date']");
            const lateDateInput = row.querySelectorAll("input[type='hidden'][name$='late-date']");
            const lateNoDeductDateInput = row.querySelectorAll("input[type='hidden'][name$='late-no-deduct-date']");
            const punchCardMissCheckboxes = row.querySelectorAll("input[type='checkbox'][name='punch-card-miss']");
            const mDateInput = row.querySelectorAll("input[type='hidden'][name$='-m-date']");
            const fDateInput = row.querySelectorAll("input[type='hidden'][name$='-f-date']"); // æ–°å¢å–ªå‡æ—¥æœŸ
            const overtimeDateInput = row.querySelectorAll("input[type='hidden'][name$='overtime-date']"); // æ–°å¢è¶…æ™‚æ—¥æœŸ            
            
            
            const vDayChecked = row.querySelector("input[data-type='v-day']").checked ? 1 : 0;
            const vHourVal = parseFloat(row.querySelector("input[data-type='v-hour']").value) || 0;
            const pDayChecked = row.querySelector("input[data-type='p-day']").checked ? 1 : 0;
            const pHourVal = parseFloat(row.querySelector("input[data-type='p-hour']").value) || 0;
            const sDayChecked = row.querySelector("input[data-type='s-day']").checked ? 1 : 0;
            const sHourVal = parseFloat(row.querySelector("input[data-type='s-hour']").value) || 0;
            const lateMinVal = parseFloat(row.querySelector("input[data-type='late-min']").value) || 0;
            const lateNoDeductMinVal = parseFloat(row.querySelector("input[data-type='late-no-deduct-min']").value) || 0;
            const punchInVal = punchCardMissCheckboxes[0].checked;
            const punchOutVal = punchCardMissCheckboxes[1].checked;
            const mHourVal = parseFloat(row.querySelector("input[data-type='m-hour']").value) || 0;
            const fDayChecked = row.querySelector("input[data-type='f-day']").checked ? 1 : 0; // å–ªå‡å¤©
            const fHourVal = parseFloat(row.querySelector("input[data-type='f-hour']").value) || 0; // å–ªå‡æ™‚
            const otHourVal = parseFloat(row.querySelector("input[data-type='overtime-hour']").value) || 0; // è¶…æ™‚æ™‚
            
            vDay += vDayChecked;
            vHour += vHourVal;
            pDay += pDayChecked;
            pHour += pHourVal;
            sDay += sDayChecked;
            sHour += sHourVal;
            lateMin += lateMinVal;
            lateNoDeductMin += lateNoDeductMinVal;
            fDay += fDayChecked; // ç´¯åŠ å–ªå‡å¤©
            fHour += fHourVal; // ç´¯åŠ å–ªå‡æ™‚
            otHour += otHourVal; // ç´¯åŠ è¶…æ™‚æ™‚
            
            
            if (vDayChecked) vacationRecords.push({ days: 1, date: vDateInput[0].value, type: 'å¤©' });
            if (vHourVal > 0) vacationRecords.push({ hours: vHourVal, date: vDateInput[1].value, type: 'å°æ™‚' });
            if (pDayChecked) leaveRecords.push({ days: 1, date: pDateInput[0].value });
            if (pHourVal > 0) leaveRecords.push({ hours: pHourVal, date: pDateInput[1].value });
            if (sDayChecked) sickRecords.push({ days: 1, date: sDateInput[0].value });
            if (sHourVal > 0) sickRecords.push({ hours: sHourVal, date: sDateInput[1].value });
            if (lateMinVal > 0) lateRecords.push({ minutes: lateMinVal, date: lateDateInput[0].value });
            if (lateNoDeductMinVal > 0) lateNoDeductRecords.push({ minutes: lateNoDeductMinVal, date: lateNoDeductDateInput[0].value });
            if (punchInVal) {
                punchInCount++;
                punchCardMissRecords.push({ type: 'ä¸Šç­', date: date });
            }
            if (punchOutVal) {
                punchOutCount++;
                punchCardMissRecords.push({ type: 'ä¸‹ç­', date: date });
            }
            if (mHourVal > 0) {
                menstrualRecords.push({ hours: mHourVal, date: mDateInput[0].value });
                mHour += mHourVal;
            }
            if (fDayChecked) funeralRecords.push({ days: 1, date: fDateInput[0].value }); // å–ªå‡å¤©è¨˜éŒ„
            if (fHourVal > 0) funeralRecords.push({ hours: fHourVal, date: fDateInput[1].value }); // å–ªå‡æ™‚è¨˜éŒ„
            if (otHourVal > 0) overtimeRecords.push({ hours: otHourVal, date: overtimeDateInput[0].value }); // è¶…æ™‚æ™‚è¨˜éŒ„
        });         
        
        
        

        const name = document.getElementById("teacherNameLeave").value.trim();
        const head = name ? `${name}\n` : '';

        let result = '';
        if (vDay > 0 || vHour > 0) {
        result += `âœ… ç‰¹ä¼‘/è£œä¼‘ï¼š${vDay} å¤© ${vHour} å°æ™‚`;
        const vacationDetails = vacationRecords.map(record =>`(${record.date} ${record.hours || record.days}${record.hours ? 'å°æ™‚' : 'å¤©'})` ).join('ã€');

        if (vacationDetails) result += `     ${vacationDetails}\n`;
        }


        const totalBufferCount = lateNoDeductRecords.length + punchInCount + punchOutCount;
        if (lateNoDeductMin > 0 || punchInCount > 0 || punchOutCount > 0) {
            let bufferString = `âœ… å…¨å‹¤ç·©è¡ï¼š`;
            const lateDetails = lateNoDeductRecords.map(record => `${record.date} ${record.minutes}åˆ†é˜`).join('ã€');
            const punchCardDetails = punchCardMissRecords.map(record => `${record.date} ${record.type}`).join('ã€');

            if (lateNoDeductMin > 0) bufferString += `é²åˆ° ${lateDetails}`;
            if (punchInCount > 0 || punchOutCount > 0) {
                if (lateNoDeductMin > 0) bufferString += "ï¼Œ";
                bufferString += `æ¼æ‰“å¡ ${punchCardDetails}`;
            }
            if (totalBufferCount > 3) bufferString += " (æ²’æœ‰å…¨å‹¤äº†âš ï¸)";
            result += bufferString + "\n";
        }
        if (fDay > 0 || fHour > 0) { // é¡¯ç¤ºå–ªå‡çµ±è¨ˆ
          result += `âœ… å–ªå‡ï¼š${fDay} å¤© ${fHour} å°æ™‚`;
          const funeralDetails = funeralRecords.map(record => `(${record.date} ${record.hours || record.days}${record.hours ? 'å°æ™‚' : 'å¤©'})`).join('ã€');
          if (funeralDetails) result += `     ${funeralDetails}\n`;
       }
       if (otHour > 0) { // é¡¯ç¤ºè¶…æ™‚çµ±è¨ˆ
          result += `âœ… è¶…æ™‚ï¼š${otHour} å°æ™‚`;
          const overtimeDetails = overtimeRecords.map(record => `(${record.date} ${record.hours}å°æ™‚)`).join('ã€');
          if (overtimeDetails) result += `     ${overtimeDetails}\n`;
       }


        if (pDay > 0 || pHour > 0) {
         result += `âœ… äº‹å‡ï¼š${pDay} å¤© ${pHour} å°æ™‚`;
         const leaveDetails = leaveRecords.map(record => `(${record.date} ${record.hours || record.days}${record.hours ? 'å°æ™‚' : 'å¤©'})`).join('ã€');
       
    if (leaveDetails) result += `     ${leaveDetails}\n`;
}
        if (sDay > 0 || sHour > 0) {
    result += `âœ… ç—…å‡ï¼š${sDay} å¤© ${sHour} å°æ™‚`;
    const sickDetails = sickRecords.map(record => `(${record.date} ${record.hours || record.days}${record.hours ? 'å°æ™‚' : 'å¤©'})` ).join('ã€');
    if (sickDetails) result += `     ${sickDetails}\n`;
}
     if (mHour > 0) {
    result += `âœ… ç”Ÿç†å‡ï¼š${mHour} å°æ™‚ ${mHour > 8 ? "(è¶…éé¡åº¦âš ï¸)" : ""}`;
    const mDetails = menstrualRecords.map(record => `(${record.date} ${record.hours}å°æ™‚)`).join('ã€');
    if (mDetails) result += `ã€€ã€€${mDetails}\n`;
}
       if (lateMin > 0) {
    result += `âœ… é²åˆ°ï¼š${lateMin} åˆ†é˜`; 
    const lateDetails = lateRecords.map(record => `(${record.date} ${record.minutes}åˆ†é˜)`).join('ã€');
    if (lateDetails) result += `ã€€ã€€${lateDetails}\n`;
}


        document.getElementById("resultsLeave").innerText = head + result;

     }

     function copyResultsLeave() {
        const resultText = document.getElementById("resultsLeave").innerText;
        navigator.clipboard.writeText(resultText).then(() => {
            alert("å·²è¤‡è£½çµ±è¨ˆçµæœï¼");
        }, () => {
            alert("è¤‡è£½å¤±æ•—ï¼Œè«‹æ‰‹å‹•é¸å–å…§å®¹ï¼");
        });
     }

     function importLeaveResults() {
        let totalLeaveDays = 0;
        let totalLeaveHours = 0;
        leaveRecords.forEach(record => {
            if (record.days) totalLeaveDays += record.days;
            if (record.hours) totalLeaveHours += record.hours;
        });

        let totalSickDays = 0;
        let totalSickHours = 0;
        sickRecords.forEach(record => {
            if (record.days) totalSickDays += record.days;
            if (record.hours) totalSickHours += record.hours;
        });

        let totalLateMinutes = 0;
        lateRecords.forEach(record => {
            if (record.minutes) totalLateMinutes += record.minutes;
        });

        let totalMenstrualHours = 0;
        menstrualRecords.forEach(record => {
            if (record.hours) totalMenstrualHours += record.hours;
        });

        document.getElementById("leaveDaysSalary").value = totalLeaveDays;
        document.getElementById("leaveHoursSalary").value = totalLeaveHours;
        document.getElementById("sickDaysSalary").value = totalSickDays;
        document.getElementById("sickHoursSalary").value = totalSickHours;
        document.getElementById("lateMinutesSalary").value = totalLateMinutes;
        document.getElementById("menstrualHoursSalary").value = totalMenstrualHours;

        const teacherNameLeave = document.getElementById("teacherNameLeave").value.trim();
        if (teacherNameLeave) {
            document.getElementById("nameSalary").value = teacherNameLeave;
        }

        alert("å‡åˆ¥çµ±è¨ˆçµæœå·²åŒ¯å…¥ä¸è¨ˆè–ªè¨ˆç®—ï¼");
     }
     </script>


    <hr>

    <script>
    function getValue(id) {
        const val = parseFloat(document.getElementById(id).value);
        return isNaN(val) ? 0 : val;
    }

    function calculateSalaryDeduction() {
        const name = document.getElementById("nameSalary").value.trim();
        const salary = getValue("salary");
        const leaveDays = getValue("leaveDaysSalary");
        const leaveHours = getValue("leaveHoursSalary");
        const sickDays = getValue("sickDaysSalary");
        const sickHours = getValue("sickHoursSalary");
        const lateMinutes = getValue("lateMinutesSalary");
        const menstrualHours = getValue("menstrualHoursSalary");

        let leaveDaysNote = "", leaveHoursNote = "", sickDaysNote = "", sickHoursNote = "";
        let lateNote = "", menstrualNote = "", vacationDaysNote = "", vacationHoursNote = "";

        leaveRecords.forEach(record => {
   if (record.days) leaveDaysNote += `ï¼ˆ${record.date} ${record.days}å¤©ï¼‰`;
   if (record.hours) leaveHoursNote += `ï¼ˆ${record.date} ${record.hours}å°æ™‚ï¼‰`;
        });

        sickRecords.forEach(record => {
   if (record.days) sickDaysNote += `ï¼ˆ${record.date} ${record.days}å¤©ï¼‰`;
   if (record.hours) sickHoursNote += `ï¼ˆ${record.date} ${record.hours}å°æ™‚ï¼‰`;
        });

        lateRecords.forEach(record => {
   if (record.minutes) lateNote += `ï¼ˆ${record.date} ${record.minutes}åˆ†é˜ï¼‰`;
        });

        menstrualRecords.forEach(record => {
   if (record.hours) menstrualNote += `ï¼ˆ${record.date} ${record.hours}å°æ™‚ï¼‰`;
        });

        vacationRecords.forEach(record => {
            if (record.type === "å¤©") {
                vacationDaysNote += `ï¼ˆ${record.date} ${record.hours}å¤©ï¼‰`;
            } else if (record.type === "å°æ™‚") {
                vacationHoursNote += `ï¼ˆ${record.date} ${record.hours}å°æ™‚ï¼‰`;
            }
        });

        if (salary <= 0) {
            document.getElementById("salaryResult").innerText = "âš ï¸ è«‹å¡«å…¥åŸå§‹æœˆè–ª";
            return;
        }

        const leaveDayDeduct = Math.floor((salary / 30) * leaveDays);
        const leaveHourDeduct = Math.floor((salary / 30 / 8) * leaveHours);
        const sickDayDeduct = Math.floor((salary / 30 / 2) * sickDays);
        const sickHourDeduct = Math.floor((salary / 30 / 8 / 2) * sickHours);
        const lateDeduct = Math.floor((salary / 30 / 8 / 60) * lateMinutes);
        const menstrualDeduct = Math.floor((salary / 30 / 8 / 2) * menstrualHours);

        const totalDeduct = leaveDayDeduct + leaveHourDeduct + sickDayDeduct + sickHourDeduct + lateDeduct + menstrualDeduct;

        let formula = `${name ? name + "ï¼š" : ""}ä¸æ”¯è–ªæ˜ç´°å¦‚ä¸‹ï¼š\n`;

        if (leaveDays) formula += `â–äº‹å‡ ${leaveDays}å¤© Ã— ${salary}/30 = ${leaveDayDeduct}å…ƒ ${leaveDaysNote}\n`;
        if (leaveHours) formula += `â–äº‹å‡ ${leaveHours}å°æ™‚ Ã— ${salary}/30/8 = ${leaveHourDeduct}å…ƒ ${leaveHoursNote}\n`;
        if (sickDays) formula += `â–ç—…å‡ ${sickDays}å¤© Ã— ${salary}/30/2 = ${sickDayDeduct}å…ƒ ${sickDaysNote}\n`;
        if (sickHours) formula += `â–ç—…å‡ ${sickHours}å°æ™‚ Ã— ${salary}/30/8/2 = ${sickHourDeduct}å…ƒ ${sickHoursNote}\n`;
        if (lateMinutes) formula += `â–é²åˆ° ${lateMinutes}åˆ†é˜ Ã— ${salary}/30/8/60 = ${lateDeduct}å…ƒ ${lateNote}\n`;
        if (menstrualHours) formula += `â–ç”Ÿç†å‡ ${menstrualHours}å°æ™‚ Ã— ${salary}/30/8/2 = ${menstrualDeduct}å…ƒ ${menstrualNote}\n`;

        formula += `ä¸æ”¯è–ªé‡‘é¡ï¼š${totalDeduct} å…ƒ`;

        document.getElementById("salaryResult").innerText = formula;
    }

    function copyResultsSalary() {
        const text = document.getElementById("salaryResult").innerText;
        if (!text) {
            alert("âš ï¸ å°šæœªç”¢ç”Ÿçµæœ");
            return;
        }
        navigator.clipboard.writeText(text)
            .then(() => alert("âœ… å·²è¤‡è£½ç®—å¼ï¼"))
            .catch(err => alert("âŒ è¤‡è£½å¤±æ•—ï¼š" + err));
    }
    </script>
    <script>
    //ä»¥ä¸‹ç‚ºç‰¹ä¼‘è£œä¼‘æŠ˜ç¾å€
function calculateCashOut() {
  const name = document.getElementById("cashOutName").value.trim();
  const salary = parseFloat(document.getElementById("cashOutSalary").value);
  const days = parseFloat(document.getElementById("cashOutDays").value) || 0;
  const hours = parseFloat(document.getElementById("cashOutHours").value) || 0;

  if (!salary || salary <= 0) {
    document.getElementById("cashOutResult").innerText = "âš ï¸ è«‹å¡«å…¥æ­£ç¢ºçš„æœˆè–ª";
    return;
  }

  const dayCash = Math.floor((salary / 30) * days);
  const hourCash = Math.floor((salary / 30 / 8) * hours);
  const total = dayCash + hourCash;

  let formula = `${name ? name + "ï¼š" : ""}å¹´å‡.ç‰¹ä¼‘.è£œä¼‘æŠ˜ç¾æ˜ç´°å¦‚ä¸‹ï¼š\n`;
  if (days > 0) formula += `â•ç‰¹ä¼‘ ${days} å¤© Ã— ${salary}/30 = ${dayCash} å…ƒ\n`;
  if (hours > 0) formula += `â•è£œä¼‘ ${hours} å°æ™‚ Ã— ${salary}/30/8 = ${hourCash} å…ƒ\n`;
  formula += `æŠ˜ç¾é‡‘é¡ç¸½è¨ˆï¼š${total} å…ƒ`;

  document.getElementById("cashOutResult").innerText = formula;
}

function copyCashOutResult() {
  const text = document.getElementById("cashOutResult").innerText;
  if (!text) {
    alert("âš ï¸ å°šæœªç”¢ç”Ÿçµæœ");
    return;
  }
  navigator.clipboard.writeText(text)
    .then(() => alert("âœ… å·²è¤‡è£½æŠ˜ç¾ç®—å¼ï¼"))
    .catch(err => alert("âŒ è¤‡è£½å¤±æ•—ï¼š" + err));
}
</script>    
    

<h2>ç‰¹ä¼‘è£œä¼‘æŠ˜ç¾å€</h2>
<label>è€å¸«å§“åï¼ˆå¯ç•™ç©ºï¼‰ï¼š</label>
<input type="text" id="cashOutName" style="width: 100px" placeholder="ä¾‹å¦‚ï¼šå¼µæ­£è¯"><br>

<label>åŸå§‹æœˆè–ªï¼š</label>
<input type="number" id="cashOutSalary" style="width: 100px" placeholder="ä¾‹å¦‚ï¼š32000"><br>

<label>æŠ˜ç¾ç‰¹ä¼‘ï¼ˆå¤©ï¼‰ï¼š</label>
<input type="number" id="cashOutDays" style="width: 60px" placeholder="0">

<label>æŠ˜ç¾è£œä¼‘ï¼ˆå°æ™‚ï¼‰ï¼š</label>
<input type="number" id="cashOutHours" style="width: 60px" placeholder="0"><br>

<button onclick="calculateCashOut()">è¨ˆç®—æŠ˜ç¾</button>

<div class="result-box" id="cashOutResult"></div><br>
<button onclick="copyCashOutResult()">ğŸ“‹ è¤‡è£½ç®—å¼</button>
</body>
</html>
