<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>出缺勤紀錄查詢</title>
  <script src="https://www.gstatic.com/charts/loader.js"></script>
  <script>
    google.charts.load('current', {'packages':['table']});

    function search() {
      const name = document.getElementById('nameInput').value.trim();
      if (!name) {
        alert('請輸入姓名');
        return;
      }

      const query = new google.visualization.Query(
        "https://docs.google.com/spreadsheets/d/1iLrvWxyhpfrvOH4ZI1zK_4MzGRzrFKq0INfdyDJYjMg/gviz/tq?sheet=工作表1"
      );

      query.setQuery(`select A,B,C,D,E,F where C = '${name}'`);
      query.send(function(response) {
        if (response.isError()) {
          document.getElementById('result').innerHTML = '查詢失敗：' + response.getMessage();
          return;
        }

        const data = response.getDataTable();
        if (data.getNumberOfRows() === 0) {
          document.getElementById('result').innerHTML = '查無資料。';
          return;
        }

        const table = new google.visualization.Table(document.getElementById('result'));
        table.draw(data, {showRowNumber: false, width: '100%', height: 'auto'});
      });
    }

    google.charts.setOnLoadCallback(() => {
      document.getElementById('searchBtn').addEventListener('click', search);
    });
  </script>
</head>
<body style="font-family: 'Segoe UI', '微軟正黑體', sans-serif; padding: 30px; background-color: #f9f9f9;">
  <h2>📋 出缺勤紀錄查詢</h2>
  <label for="nameInput">請輸入姓名：</label>
  <input type="text" id="nameInput" placeholder="例如：卡比" style="padding: 8px; font-size: 16px;">
  <button id="searchBtn" style="padding: 8px 16px; margin-left: 10px; font-size: 16px; cursor: pointer;">查詢</button>

  <div id="result" style="margin-top: 30px;"></div>
</body>
</html>
