<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>å‡ºç¼ºå‹¤ç´€éŒ„æŸ¥è©¢</title>
  <script src="https://www.gstatic.com/charts/loader.js"></script>
  <script>
    google.charts.load('current', {'packages':['table']});

    function search() {
      const name = document.getElementById('nameInput').value.trim();
      if (!name) {
        alert('è«‹è¼¸å…¥å§“å');
        return;
      }

      const query = new google.visualization.Query(
        "https://docs.google.com/spreadsheets/d/1iLrvWxyhpfrvOH4ZI1zK_4MzGRzrFKq0INfdyDJYjMg/gviz/tq?sheet=å·¥ä½œè¡¨1"
      );

      query.setQuery(`select A,B,C,D,E,F where C = '${name}'`);
      query.send(function(response) {
        if (response.isError()) {
          document.getElementById('result').innerHTML = 'æŸ¥è©¢å¤±æ•—ï¼š' + response.getMessage();
          return;
        }

        const data = response.getDataTable();
        if (data.getNumberOfRows() === 0) {
          document.getElementById('result').innerHTML = 'æŸ¥ç„¡è³‡æ–™ã€‚';
          return;
        }

        const table = new google.visualization.Table(document.getElementById('result'));
        table.draw(data, {showRowNumber: false, width: '100%', height: 'auto'});
      });
    }

    google.charts.setOnLoadCallback(() => {
      document.getElementById('searchBtn').addEventListener('click', search);
    });
  </script>
</head>
<body style="font-family: 'Segoe UI', 'å¾®è»Ÿæ­£é»‘é«”', sans-serif; padding: 30px; background-color: #f9f9f9;">
  <h2>ğŸ“‹ å‡ºç¼ºå‹¤ç´€éŒ„æŸ¥è©¢</h2>
  <label for="nameInput">è«‹è¼¸å…¥å§“åï¼š</label>
  <input type="text" id="nameInput" placeholder="ä¾‹å¦‚ï¼šå¡æ¯”" style="padding: 8px; font-size: 16px;">
  <button id="searchBtn" style="padding: 8px 16px; margin-left: 10px; font-size: 16px; cursor: pointer;">æŸ¥è©¢</button>

  <div id="result" style="margin-top: 30px;"></div>
</body>
</html>
